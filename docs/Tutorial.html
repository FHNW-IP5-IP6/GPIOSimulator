<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>FHNW Pi4J Tutorial</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#_einleitung">Einleitung</a></li>
<li><a href="#_hardware">1. Hardware</a>
<ul class="sectlevel2">
<li><a href="#_raspberry_pi">1.1. Raspberry Pi</a></li>
<li><a href="#_grove_sensoren_aktuatoren">1.2. Grove Sensoren &amp; Aktuatoren</a></li>
<li><a href="#_grove_base_hat">1.3. Grove Base Hat</a>
<ul class="sectlevel3">
<li><a href="#_pwm">1.3.1. PWM</a></li>
<li><a href="#_uart">1.3.2. UART</a></li>
<li><a href="#_digital">1.3.3. Digital</a></li>
<li><a href="#_analog">1.3.4. Analog</a></li>
<li><a href="#_i2c">1.3.5. I2C</a></li>
</ul>
</li>
<li><a href="#_breadboard">1.4. Breadboard</a></li>
</ul>
</li>
<li><a href="#_software">2. Software</a>
<ul class="sectlevel2">
<li><a href="#_java">2.1. Java</a></li>
<li><a href="#_pi4j">2.2. Pi4J</a></li>
<li><a href="#_log4j_2">2.3. Log4j 2</a></li>
</ul>
</li>
<li><a href="#_setup_des_raspberrypi">3. Setup des RaspberryPi</a>
<ul class="sectlevel2">
<li><a href="#_vorbereitung_der_mini_sd_karte">3.1. Vorbereitung der Mini SD-Karte</a></li>
<li><a href="#_raspberry_pi_mit_zusätzlicher_hardware_nutzen">3.2. Raspberry Pi mit zusätzlicher Hardware nutzen</a></li>
<li><a href="#_raspberry_pi_ohne_zusätzliche_hardware_nutzen">3.3. Raspberry Pi ohne zusätzliche Hardware nutzen</a>
<ul class="sectlevel3">
<li><a href="#_zugriff_über_ssh">3.3.1. Zugriff über SSH</a></li>
<li><a href="#_zugriff_über_wifi">3.3.2. Zugriff über WiFi</a></li>
<li><a href="#_zugriff_auf_ui_via_vnc_viewer">3.3.3. Zugriff auf UI via VNC Viewer</a></li>
</ul>
</li>
<li><a href="#_installation_von_zusätzlicher_software_auf_dem_pi">3.4. Installation von zusätzlicher Software auf dem Pi</a>
<ul class="sectlevel3">
<li><a href="#_java_2">3.4.1. Java</a></li>
<li><a href="#_gradle">3.4.2. Gradle</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_code_auf_dem_pi_bauen">4. Code auf dem Pi bauen</a>
<ul class="sectlevel2">
<li><a href="#_remote_host_in_intellij">4.1. Remote Host in IntelliJ</a></li>
<li><a href="#_code_mit_gradle_bauen">4.2. Code mit Gradle bauen</a></li>
<li><a href="#_optional_remote_debugging">4.3. Optional: Remote Debugging</a></li>
</ul>
</li>
<li><a href="#_beispiele">5. Beispiele</a>
<ul class="sectlevel2">
<li><a href="#_led">5.1. LED</a>
<ul class="sectlevel3">
<li><a href="#_verkabelung">5.1.1. Verkabelung</a></li>
<li><a href="#_api">5.1.2. API</a></li>
<li><a href="#_anwendungsbeispiel">5.1.3. Anwendungsbeispiel</a></li>
</ul>
</li>
<li><a href="#_button">5.2. Button</a>
<ul class="sectlevel3">
<li><a href="#_verkabelung_2">5.2.1. Verkabelung</a></li>
<li><a href="#_api_2">5.2.2. API</a></li>
<li><a href="#_anwendungsbeispiel_2">5.2.3. Anwendungsbeispiel</a></li>
</ul>
</li>
<li><a href="#_buzzer">5.3. Buzzer</a>
<ul class="sectlevel3">
<li><a href="#_verkabelung_3">5.3.1. Verkabelung</a></li>
<li><a href="#_api_3">5.3.2. API</a></li>
<li><a href="#_anwendungsbeispiel_3">5.3.3. Anwendungsbeispiel</a></li>
</ul>
</li>
<li><a href="#_lcd_i2c">5.4. LCD I2C</a>
<ul class="sectlevel3">
<li><a href="#_verkabelung_4">5.4.1. Verkabelung</a></li>
<li><a href="#_api_4">5.4.2. API</a></li>
<li><a href="#_anwendungsbeispiel_4">5.4.3. Anwendungsbeispiel</a></li>
</ul>
</li>
<li><a href="#_potentiometer">5.5. Potentiometer</a>
<ul class="sectlevel3">
<li><a href="#_verkabelung_5">5.5.1. Verkabelung</a></li>
<li><a href="#_api_5">5.5.2. API</a></li>
<li><a href="#_anwendungsbeispiel_5">5.5.3. Anwendungsbeispiel</a></li>
</ul>
</li>
<li><a href="#_grove_rfid_reader">5.6. Grove RFID Reader</a>
<ul class="sectlevel3">
<li><a href="#_verkabelung_6">5.6.1. Verkabelung</a></li>
<li><a href="#_api_6">5.6.2. API</a></li>
<li><a href="#_anwendungsbeispiel_6">5.6.3. Anwendungsbeispiel</a></li>
</ul>
</li>
<li><a href="#_ultrasonic_ranger">5.7. Ultrasonic Ranger</a>
<ul class="sectlevel3">
<li><a href="#_verkabelung_7">5.7.1. Verkabelung</a></li>
<li><a href="#_api_7">5.7.2. API</a></li>
<li><a href="#_anwendungsbeispiel_7">5.7.3. Anwendungsbeispiel</a></li>
</ul>
</li>
<li><a href="#_dc_motor">5.8. DC Motor</a>
<ul class="sectlevel3">
<li><a href="#_verkabelung_8">5.8.1. Verkabelung</a></li>
<li><a href="#_api_8">5.8.2. API</a></li>
<li><a href="#_anwendungsbeispiel_8">5.8.3. Anwendungsbeispiel</a></li>
</ul>
</li>
<li><a href="#_stepper_motor">5.9. Stepper Motor</a>
<ul class="sectlevel3">
<li><a href="#_verkabelung_9">5.9.1. Verkabelung</a></li>
<li><a href="#_api_9">5.9.2. API</a></li>
<li><a href="#_anwendungsbeispiel_9">5.9.3. Anwendungsbeispiel</a></li>
</ul>
</li>
<li><a href="#_servo_motor">5.10. Servo Motor</a>
<ul class="sectlevel3">
<li><a href="#_verkabelung_10">5.10.1. Verkabelung</a></li>
<li><a href="#_api_10">5.10.2. API</a></li>
<li><a href="#_anwendungsbeispiel_10">5.10.3. Anwendungsbeispiel</a></li>
</ul>
</li>
<li><a href="#_grove_serial_camera">5.11. Grove Serial Camera</a>
<ul class="sectlevel3">
<li><a href="#_verkabelung_11">5.11.1. Verkabelung</a></li>
<li><a href="#_api_11">5.11.2. API</a></li>
<li><a href="#_anwendungsbeispiel_11">5.11.3. Anwendungsbeispiel</a></li>
</ul>
</li>
<li><a href="#_raspberry_pi_camera">5.12. Raspberry Pi Camera</a>
<ul class="sectlevel3">
<li><a href="#_verkabelung_12">5.12.1. Verkabelung</a></li>
<li><a href="#_api_12">5.12.2. API</a></li>
<li><a href="#_anwendungsbeispiel_12">5.12.3. Anwendungsbeispiel</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_beispielprojekt">6. Beispielprojekt</a>
<ul class="sectlevel2">
<li><a href="#_komponenten_klassen_als_library_hinzufügen">6.1. Komponenten Klassen als Library hinzufügen</a></li>
</ul>
</li>
<li><a href="#_zusatzinformationen">7. Zusatzinformationen</a>
<ul class="sectlevel2">
<li><a href="#_led_2">7.1. LED</a>
<ul class="sectlevel3">
<li><a href="#_status_modifizieren">7.1.1. Status modifizieren</a></li>
<li><a href="#_helligkeit_via_pwm_setzen">7.1.2. Helligkeit via PWM setzen</a></li>
</ul>
</li>
<li><a href="#_button_2">7.2. Button</a>
<ul class="sectlevel3">
<li><a href="#_pulldown_wiederstand_im_schaltbild">7.2.1. Pulldown-Wiederstand im Schaltbild</a></li>
<li><a href="#_pulldown_wiederstand_des_raspberry_pi">7.2.2. Pulldown-Wiederstand des Raspberry Pi</a></li>
<li><a href="#_zustand_lesen">7.2.3. Zustand lesen</a></li>
</ul>
</li>
<li><a href="#_buzzer_2">7.3. Buzzer</a>
<ul class="sectlevel3">
<li><a href="#_clock_divider_berechnen">7.3.1. Clock Divider berechnen</a></li>
<li><a href="#_ton_abspielen">7.3.2. Ton abspielen</a></li>
</ul>
</li>
<li><a href="#_lcd_i2c_2">7.4. LCD I2C</a>
<ul class="sectlevel3">
<li><a href="#_befehle_für_den_lcd1602">7.4.1. Befehle für den LCD1602</a></li>
<li><a href="#_initialisierung">7.4.2. Initialisierung</a></li>
<li><a href="#_text_auf_dem_display_anzeigen">7.4.3. Text auf dem Display anzeigen</a></li>
<li><a href="#_spezielle_anzeigefunktionen">7.4.4. Spezielle Anzeigefunktionen</a></li>
</ul>
</li>
<li><a href="#_grove_rfid_reader_2">7.5. Grove RFID Reader</a>
<ul class="sectlevel3">
<li><a href="#_kompatibilität_mit_rfid_tag">7.5.1. Kompatibilität mit RFID Tag</a></li>
<li><a href="#_rfid_tag_daten_ausgeben">7.5.2. RFID Tag Daten ausgeben</a></li>
</ul>
</li>
<li><a href="#_grove_ultrasonic_ranger">7.6. Grove Ultrasonic Ranger</a>
<ul class="sectlevel3">
<li><a href="#_trigger_signal">7.6.1. Trigger Signal</a></li>
<li><a href="#_echo_messen">7.6.2. Echo messen</a></li>
</ul>
</li>
<li><a href="#_potentiometer_2">7.7. Potentiometer</a>
<ul class="sectlevel3">
<li><a href="#_konstruktor">7.7.1. Konstruktor</a></li>
<li><a href="#_wertebereich_setzen">7.7.2. Wertebereich setzen</a></li>
<li><a href="#_value_lesen">7.7.3. Value lesen</a></li>
</ul>
</li>
<li><a href="#_dc_motor_2">7.8. DC Motor</a>
<ul class="sectlevel3">
<li><a href="#_motor_treiber_l293d">7.8.1. Motor Treiber L293D</a></li>
<li><a href="#_drehrichtung_wechseln">7.8.2. Drehrichtung wechseln</a></li>
<li><a href="#_geschwindigkeit_anpassen">7.8.3. Geschwindigkeit anpassen</a></li>
</ul>
</li>
<li><a href="#_stepper_motor_2">7.9. Stepper Motor</a>
<ul class="sectlevel3">
<li><a href="#_single_stepping">7.9.1. Single Stepping</a></li>
<li><a href="#_double_stepping">7.9.2. Double Stepping</a></li>
<li><a href="#_half_stepping">7.9.3. Half Stepping</a></li>
<li><a href="#_motor_drehen">7.9.4. Motor drehen</a></li>
<li><a href="#_drehrichtung_ändern">7.9.5. Drehrichtung ändern</a></li>
</ul>
</li>
<li><a href="#_servo_motor_2">7.10. Servo Motor</a>
<ul class="sectlevel3">
<li><a href="#_steuerung_über_pwm">7.10.1. Steuerung über PWM</a></li>
<li><a href="#_winkel_setzen">7.10.2. Winkel setzen</a></li>
</ul>
</li>
<li><a href="#_grove_serial_camera_2">7.11. Grove Serial Camera</a>
<ul class="sectlevel3">
<li><a href="#_protokoll">7.11.1. Protokoll</a></li>
<li><a href="#_verbindung_mit_der_kamera_aufbauen">7.11.2. Verbindung mit der Kamera aufbauen</a></li>
<li><a href="#_jpeg_foto_anfordern">7.11.3. JPEG Foto anfordern</a></li>
<li><a href="#_bildgrösser_ermitteln">7.11.4. Bildgrösser ermitteln</a></li>
<li><a href="#_bild_pakete_empfangen">7.11.5. Bild Pakete empfangen</a></li>
</ul>
</li>
<li><a href="#_raspberry_pi_camera_2">7.12. Raspberry Pi Camera</a>
<ul class="sectlevel3">
<li><a href="#_terminal_befehle">7.12.1. Terminal Befehle</a></li>
<li><a href="#_java_library_für_bildaufnahme">7.12.2. Java Library für Bildaufnahme</a></li>
<li><a href="#_bildaufnahme">7.12.3. Bildaufnahme</a></li>
<li><a href="#_videoaufnahme">7.12.4. Videoaufnahme</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_literaturverzeichnis">Literaturverzeichnis</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="imageblock">
<div class="content">
<img src="./assets/images/FHNW.png" alt="FHNW" width="382" height="59">
</div>
</div>
<h1 id="_ip5_fhnw_pi4j_tutorial" class="discrete">IP5: FHNW Pi4J Tutorial</h1>
<div class="paragraph">
<p><strong>Autoren</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Herr Jonathan Bättig (<a href="mailto:jonathan.baettig@students.fhnw.ch">jonathan.baettig@students.fhnw.ch</a>)</p>
</li>
<li>
<p>Herr Anessollah Ima (<a href="mailto:anessollah.ima@students.fhnw.ch">anessollah.ima@students.fhnw.ch</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>FHNW</strong><br>
<strong>Hochschule für Technik</strong><br>
<strong>Studiengang</strong> : Informatik<br>
<strong>Semester</strong> : 6BB</p>
</div>
<div class="paragraph">
<p><strong>Betreuende Dozenten</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Frau Dr. Barbara Scheuner (<a href="mailto:barbara.scheuner@fhnw.ch">barbara.scheuner@fhnw.ch</a>)</p>
</li>
<li>
<p>Herr Dr. Dieter Holz (<a href="mailto:dieter.holz@fhnw.ch">dieter.holz@fhnw.ch</a>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Datum</strong>: 2020-08-10</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div style="page-break-after: always;"></div>
<div class="sect1">
<h2 id="_einleitung">Einleitung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dieses Tutorial soll den Studierenden der FHNW eine Hilfestellung bieten für die IoT Projekte in IP1/2. Es wird gezeigt, wie der Raspberry Pi grundlegend funktioniert und wie es mit anderen Geräten interagieren kann. Das Ziel dieses Tutorials ist es, dass die Entwicklung und die Arbeit an der Software der Projekte in den Vordergrund rückt und der elektrotechnische Teil erleichtert wird. Im Fokus bei der Entwicklung steht Java mit der Pi4J-Library, welche für Java IoT-Projekte auf dem Raspberry Pi genutzt wird.</p>
</div>
<div class="paragraph">
<p>Der Hauptteil des Tutorials befasst sich mit verschiedenen Sensoren und Aktoren, welche an den Raspberry Pi angeschlossen werden können, welche zur erleichterten Verwendung hauseigene Komponenten-Klassen in Java bekommen haben. Diese Komponenten-Klassen können als Library in den IoT Projekten verwendet werden.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_hardware">1. Hardware</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_raspberry_pi">1.1. Raspberry Pi</h3>
<div class="paragraph">
<p>Der Raspberry Pi ist ein kostengünstiger Computer in Kreditkartengröße. Es ist ein leistungsfähiger kleiner PC, der es Menschen jeden Alters ermöglicht, sich mit Computern auseinanderzusetzen und zu lernen, wie man in Sprachen wie Scratch, Python oder hier in Java programmiert. Es ist in der Lage, alles zu tun, was man von einem Desktop-Computer erwarten würde, vom Surfen im Internet und dem Abspielen von hochauflösenden Videos bis hin zum Erstellen von Tabellenkalkulationen, Textverarbeitung und Spielen<a href="#RaspberryPi1">[{counter:bibliography}]</a>.</p>
</div>
<div class="paragraph">
<p>Darüber hinaus hat die Raspberry Pi die Fähigkeit, mit der Außenwelt zu interagieren. An den sogenannten GPIO (General Purpose Input Output) Pins kann man diverse Sensoren und Aktoren anschliessen, was den Raspberry Pi sehr beliebt für IoT-Projekte macht<a href="#RaspberryPi2">[{counter:bibliography}]</a>.</p>
</div>
<div class="paragraph">
<p>Der Pi wurde von der britischen Raspberry Pi Foundation entwickelt und hat das Ziel, Bildung im Bereich Computer Hardware, Elektronik und Informatik zu fördern.</p>
</div>
</div>
<div class="sect2">
<h3 id="_grove_sensoren_aktuatoren">1.2. Grove Sensoren &amp; Aktuatoren</h3>
<div class="paragraph">
<p>Grove ist ein offenes modulares System, das für den einfachen Anschluss beliebiger Sensoren und Aktuatoren entwickelt wurde. Es gibt Grove Sensoren und Aktuatoren für die verschiedensten Bereiche:  Robotik, Annäherung, Bewegung, Umwelt und Biomedizin.</p>
</div>
<div class="paragraph">
<p>Grove erleichtert das Anschließen und Experimentieren mit den Geräte. Die Sensoren und Aktuatoren können mittels der Grove Kabel an einen Grove Aufsatz, wie dem Grove Base Hat angeschlossen werden, somit sind keine Jumper oder Lötkolben mehr erforderlich für einfache IoT Projekte <a href="#GroveSA">[{counter:bibliography}]</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_grove_base_hat">1.3. Grove Base Hat</h3>
<div class="paragraph">
<p>Grove Sensoren und Aktuatoren sind beliebt und werden oft in Projekten eingesetzt. Sie verfügen über simple Steckverbindungen, sogenannte Adapter, welche in Kombination mit dem Grove Base Hat eine sichere und fehlerfreie Verbindung mit dem Raspberry Pi garantieren.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://wiki.seeedstudio.com/Grove_Base_Hat_for_Raspberry_Pi/"><img src="./assets/images/Grove_Base_Hat.png" alt="500" width="500" height="Grove Base Hat"></a>
</div>
<div class="title">Figure 1. Grove Base Hat</div>
</div>
<div class="paragraph">
<p>Der Grove Base Hat stellt Adapter für PWM, Digital, Analog, UART sowie I2C zur Verfügung. Zusätzlich werden alle GPIO Pins auf den Hat projiziert. Unsere Implementation des Grove Adapters unterstützt alle diese Anschlüsse.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public enum GroveAdapter {
    A0(0x30, AdapterType.ANALOG),
    A2(0x32, AdapterType.ANALOG),
    A4(0x34, AdapterType.ANALOG),
    A6(0x36, AdapterType.ANALOG),
    D5(RaspiBcmPin.GPIO_05, RaspiBcmPin.GPIO_06, AdapterType.DIGITAL),
    D16(RaspiBcmPin.GPIO_16, RaspiBcmPin.GPIO_17, AdapterType.DIGITAL),
    D18(RaspiBcmPin.GPIO_18, RaspiBcmPin.GPIO_19, AdapterType.DIGITAL),
    D22(RaspiBcmPin.GPIO_22, RaspiBcmPin.GPIO_23, AdapterType.DIGITAL),
    D24(RaspiBcmPin.GPIO_24, RaspiBcmPin.GPIO_25, AdapterType.DIGITAL),
    D26(RaspiBcmPin.GPIO_26, RaspiBcmPin.GPIO_27, AdapterType.DIGITAL),
    I2C(I2CBus.BUS_1, AdapterType.I2C),
    PWM(RaspiBcmPin.GPIO_12, RaspiBcmPin.GPIO_13, AdapterType.PWM),
    UART(RaspiBcmPin.GPIO_14, RaspiBcmPin.GPIO_15, AdapterType.UART);

    private Adapter adapter;
    private int analogI2CBus = 0x04;

    GroveAdapter(Pin upperPin, Pin lowerPin, AdapterType type) {
        this.adapter = new Adapter(upperPin, lowerPin, type);
    }

    GroveAdapter(int deviceAddress, AdapterType type) { this.adapter = new Adapter(analogI2CBus, deviceAddress, type); }

    GroveAdapter(I2CBus bus, AdapterType type) { this.adapter = new Adapter(bus, type); }

    public Adapter getAdapter() {
        return adapter;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die Sensoren und Aktuatoren können über unsere Implementation sehr einfach verwendet werden. Das untere Beispiel zeigt, wie ein Potentiometer, welcher am Grove Base Hat Adapter A0 angeschlossen ist, erzeugt und abgefragt werden kann.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">PotentiometerComponent potentiometer = new PotentiometerComponent(GroveAdapter.A0);
potentiometer.getValue()</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_pwm">1.3.1. PWM</h4>
<div class="paragraph">
<p>Der Grove Base Hat unterstütz die Hardware PWM Pins 12 sowie 13. Beide Pins sind im selben Adapter vereinigt.</p>
</div>
</div>
<div class="sect3">
<h4 id="_uart">1.3.2. UART</h4>
<div class="paragraph">
<p>Der UART Adapter macht den Serial Bus der Raspberry Pi für Grove Sensoren und Aktuatoren verfügbar. Er benutzt die GPIO Pins 14 und 15. An diesem Port würden wir die Grove Serial Camera anschliessen, wenn diese mit 3.3 Volt kompatibel wäre.</p>
</div>
</div>
<div class="sect3">
<h4 id="_digital">1.3.3. Digital</h4>
<div class="paragraph">
<p>Der Grove Base Hat stellt sechs digitale Adapter zur Verfügung. Die Adapter stellen die Standard GPIO Pins des Pi dar. Die Pin Nummern entsprechen den Zahlen auf dem Board. Beispielsweise entspricht der Adapter D22 den Pins 22 und 23.</p>
</div>
</div>
<div class="sect3">
<h4 id="_analog">1.3.4. Analog</h4>
<div class="paragraph">
<p>Der Raspberry Pi selbst besitzt nur digitale GPIO Pins. Hier stellt uns der Grove Base Hat also zusätzliche Funktionalität zur Verfügung. An die vier analogen Adapter können analoge Sensoren und Aktuatoren angeschlossen werden. Diese kommunizieren mit einem Chip, welcher sich auf der Rückseite des Hats befindet. Dieser Chip wandelt dann die analogen Daten in ein digitales Format um. Zusätzlich implementiert der Chip das I2C Interface, über welches er mit dem Pi kommunizieren kann.</p>
</div>
<div class="paragraph">
<p>Der Chip hat die I2C Adresse 0x04. Die einzelnen analogen Anschlüsse haben jeweils eine eigene Device Adresse.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>A0</strong>: 0x30</p>
</li>
<li>
<p><strong>A2</strong>: 0x32</p>
</li>
<li>
<p><strong>A4</strong>: 0x34</p>
</li>
<li>
<p><strong>A6</strong>: 0x36</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_i2c">1.3.5. I2C</h4>
<div class="paragraph">
<p>Die drei I2C Anschlüsse sind alle mit dem I2C Bus 1 des Raspberry Pi verbunden. Mit I2C können mehrere Devices auf einmal angesteuert werden.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_breadboard">1.4. Breadboard</h3>
<div class="paragraph">
<p>Breadboards sind Prototyping-Devices, welche es in diversen Grössen und Formen gibt. Sie bieten eine einfache Möglichkeit, elektronische Komponenten miteinander zu verbinden, ohne dass diese zusammengelötet werden müssen. Sie sind daher bestens für den Testaufbau von Schaltungen geeignet.</p>
</div>
<div class="paragraph">
<p>Die untere Abbildung zeigt, wie ein solches Breadboard aufgebaut ist. In die einzelnen Punkte können Kabel oder elektronischen Leiter der einzelnen Devices eingesteckt werden. Sind Punkte miteinander verbunden, stehen sie bei Benutzung alle unter dem gleichen Strom. Die Roten Leitungen sind für die Stromzufuhr gedacht. Die blauen Leitungen können mit dem Ground Pin des Raspberry Pi verbunden werden.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://magpi.raspberrypi.org/articles/breadboard-tutorial"><img src="./assets/images/installation/breadboard.jpeg" alt="breadboard" width="75% Breadboard"></a>
</div>
<div class="title">Figure 2. <em>Breadboard</em></div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_software">2. Software</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Zur Umsetzung von GPIO Projekten benötigen wir nebst den Hardware Komponenten natürlich auch Software. Als Basis dient uns Java 8 sowie Pi4J.</p>
</div>
<div class="sect2">
<h3 id="_java">2.1. Java</h3>
<div class="paragraph">
<p>Zur Programmierung der GPIO Pins des Raspberry Pis benutzen wir die Objektorientierte Programmiersprache Java in der Version 8. Aus kompatibilitätsgründen sind neure Versionen von Java leider nicht unterstützt.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pi4j">2.2. Pi4J</h3>
<div class="paragraph">
<p>Die Software Bibliothek Pi4J bietet vollzugriff auf die I/O Funktionalität des Raspberry Pi. Die Library abstrahiert die komplexe Hardware Programmierung und bietet stattdessen einfache API-Calls an, welche direkt verwendet werden können. Folgende Funktionalität wird von Pi4J abgedeckt</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Exportieren und Importieren von GPIO Pins</p>
</li>
<li>
<p>Konfigurieren der GPIO Pin Flussrichtung</p>
</li>
<li>
<p>Lesen und Schreiben des GPIO Pin State</p>
</li>
<li>
<p>Pulse Width Modulation (Hardware &amp; Software)</p>
</li>
<li>
<p>Erstellen von GPIO State Listeners (Hardware Interrupt)</p>
</li>
<li>
<p>Automatisches setzen eines Pin State bei Programmende (GPIO Shutdown)</p>
</li>
<li>
<p>Senden und Empfangen von Daten via serielle Schnittstelle (RS232)</p>
</li>
<li>
<p>Support für Kommunikation über den I2C Bus (Inter-Integrated Circuit)</p>
</li>
<li>
<p>Support für Kommunikation über den SPI Bus (Serial Peripheral Interface)</p>
</li>
<li>
<p>Erweiterbarer GPIO Provider mit Support für GPIO Extension Boards</p>
</li>
<li>
<p>Zugriff auf System- und Netzwerkinformationen des Raspberry Pi</p>
</li>
<li>
<p>Wrapper Klassen für den direkten Zugriff auf WiringPi</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unsere Library verwendet Pi4J 1.2, da die Version 1.4 den I2C Bus des Raspberry Pi nicht unterstützt.</p>
</div>
</div>
<div class="sect2">
<h3 id="_log4j_2">2.3. Log4j 2</h3>
<div class="paragraph">
<p>Wir benutzen Log4j 2 von Apache für das Schreiben von Logs in ein Rolling File. Log4j 2 ist ein beliebter und weit verbreiteter Vertreter der Java Logging Frameworks.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setup_des_raspberrypi">3. Setup des RaspberryPi</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Bevor Sie mit der Implementation ihres ersten Raspberry Pi Projekts starten können, muss der Mini-Computer aufgesetzt werden. Im Gegensatz zu den verschiedenen im Handel erhältichen Micro Controllern, wie Beispielsweise der Arduino Uno, benötigt der Pi ein Betriebssystem. Wir verwenden das auf Linux basierende System Raspbian, eine speziell für den Raspberry Pi modifiziertes Derbian.</p>
</div>
<div class="sect2">
<h3 id="_vorbereitung_der_mini_sd_karte">3.1. Vorbereitung der Mini SD-Karte</h3>
<div class="paragraph">
<p>Wie bereits erwähnt, verwenden wir für den Betrieb des Raspberry Pi das Linux OS Raspbian. Das Betriebssystem werden Sie später auf die Ihnen zur Verfügung gestellte Mini SD-Karte installieren.</p>
</div>
<div class="paragraph">
<p>In einem ersten Schritt laden Sie bitte das Raspbian Image aus dem Internet auf Ihren Rechner und speichern die Datei ab. Besuchen Sie hierfür die Download-Website der Raspberry Organisation:<br>
<a href="https://www.raspberrypi.org/downloads/raspbian/" class="bare">https://www.raspberrypi.org/downloads/raspbian/</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/raspbianDownload.png" alt="raspbianDownload" width="75% raspbian Download">
</div>
<div class="title">Figure 3. <em>Raspbian Download</em></div>
</div>
<div class="paragraph">
<p>Wählen Sie nun die Raspbian Version <code>Raspbian Buster with desktop</code> aus. Sobald Ihr Browser den Download abgeschlossen hat, extrahieren Sie bitte den Zip-Ordner an eine beliebige Stelle. Im extrahierten Ordner befindet sich eine .img-Datei, welche wir in den folgenden Installationsschritten benötigen werden. Merken Sie sich also, wo auf dem Dateisystem der entpackte Folder liegt.</p>
</div>
<div class="paragraph">
<p>Damit Sie das Raspbian Image auf Ihre SD-Karte installieren können, brauchen Sie eine geeignete Disk Imaging Software. Wir empfehlen Ihnen dafür balenaEtcher zu verwenden. Es gibt aber auch andere dafür geeignete Programme.</p>
</div>
<div class="paragraph">
<p>Wenn Sie sich ebenfalls für balenaEtcher entscheiden, können Sie das Programm über den folgenden Link direkt von der balena Webseite herunterladen und installieren:<br>
<a href="https://www.balena.io/etcher/" class="bare">https://www.balena.io/etcher/</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/balenaDownload.png" alt="balenaDownload" width="60% balenaEtcher Download">
</div>
<div class="title">Figure 4. <em>balenaEtcher Download</em></div>
</div>
<div class="paragraph">
<p>Nachdem Sie balenaEtcher installiert haben, können Sie die Applikation starten. In nur drei einfachen Schritten spiegelt balenaEtcher das Raspbian Image auf Ihre Mini SD-Karte.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/balenaStart.png" alt="balenaStart" width="75% balenaEtcher Startbildschirm">
</div>
<div class="title">Figure 5. <em>balenaEtcher Startbildschirm</em></div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Wählen Sie in einem ersten Schritt die .img-Datei des zuvor heruntergeladenen Raspbian aus.</p>
</li>
<li>
<p>Wählen Sie nun die Mini SD-Karte aus, welche Sie an Ihren PC angeschlossen haben. Bitte beachten Sie, dass die SD-Karte während der Installation formatiert wird und somit alle sich auf der Karte befindenden Daten unwiederruflich gelöscht werden.</p>
</li>
<li>
<p>Klicken Sie auf "Flash!" um die Installation des Images zu starten. Dieser Prozess kann einige Minuten in Anspruch nehmen.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Sobald der Flash Vorgang abgeschlossen wurde, ist Raspbian auf der SD-Karte installiert und das OS ist betriebsbereit.</p>
</div>
</div>
<div class="sect2">
<h3 id="_raspberry_pi_mit_zusätzlicher_hardware_nutzen">3.2. Raspberry Pi mit zusätzlicher Hardware nutzen</h3>
<div class="paragraph">
<p>Wenn Sie den Raspberry Pi als normalen Desktop Rechner verwenden möchten, können Sie die vorbereitete Mini SD-Karte in den Pi einsetzen und weitere Hardware wie Maus, Monitor und Tastatur direkt an Ihren Pi anschliessen. Sobald Sie den Computer an das Stromnetz anschliessen, fährt Raspbian hoch und eine Login Maske erscheint.</p>
</div>
<div class="paragraph">
<p>Für das initiale Login auf dem Pi können Sie die folgenden Standard Credentials verwenden:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>User</strong>: pi</p>
</li>
<li>
<p><strong>Passwort</strong>: raspberry</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_raspberry_pi_ohne_zusätzliche_hardware_nutzen">3.3. Raspberry Pi ohne zusätzliche Hardware nutzen</h3>
<div class="paragraph">
<p>Es gibt verschiedene Gründe, weshalb Sie den Raspberry Pi ohne zusätzliche Hardware verwenden möchten. Womöglich erfüllt der Pi die Mindestanforderungen Ihrer bevorzugten Entwicklungsumgebung nicht oder Ihnen steht schlicht und einfach nicht die nötige Hardware zur Verfügung. In diesem Kapitel möchten wir Ihnen aufzeigen, wie Sie den Mini Computer ganz ohne zusätzliche Hardware konfigurieren und verwenden können. Sie benötigen dazu ledeglich ein USB-Kabel und Ihren Laptop.</p>
</div>
<div class="paragraph">
<p>Um mit dem Raspberry Pi ohne zusätzliche Hardware arbeiten zu können, wird SSH verwendet. Damit Sie via SSH auf den Pi zugreifen können, benötigen Sie eine SSH Software. Ein beliebtes Tool ist PuTTY. Sie können es unter folgendem Link direkt vom Hersteller herunterladen und auf Ihrem Rechner installieren:<br>
<a href="https://www.putty.org/" class="bare">https://www.putty.org/</a></p>
</div>
<div class="sect3">
<h4 id="_zugriff_über_ssh">3.3.1. Zugriff über SSH</h4>
<div class="paragraph">
<p>Bevor Sie sich mit PuTTY via SSH auf den Pi einloggen können, müssen Sie SSH in Raspbian aktivieren. Dazu legen Sie die SD-Karte erneut in Ihren PC ein und navigieren anschliessend mittels Datei-Explorer in den <code>boot</code> Folder der SD-Karte.</p>
</div>
<div class="paragraph">
<p>Jetzt müssen Sie verschiedene Einstellungen direkt an den markierten Files im <code>boot</code> Ordner vornehmen:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/bootFolder.png" alt="bootFolder" width="75% boot Ordner">
</div>
<div class="title">Figure 6. <em>boot Ordner</em></div>
</div>
<div class="ulist">
<ul>
<li>
<p>Im File <code>config.txt</code> müssen Sie ganz am Schluss den folgenden Snippet hinzufügen:<br></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>dtoverlay=dwc2</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Im File <code>cmdline.txt</code> müssen Sie nach dem Text "rootwait" suchen und danach den folgenden Snippet hinzufügen:<br></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>modules-load=dwc2,g_ether</pre>
</div>
</div>
<div class="paragraph">
<p>Der relevante Ausschnitt des Files sieht dann zum Beispiel so aus:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/cmdLine.png" alt="cmdLine" width="75% cmdLine file">
</div>
<div class="title">Figure 7. <em>cmdLine File</em></div>
</div>
<div class="paragraph">
<p>Zu guter Letzt erstellen Sie ein leeres File ohne Dateiendung mit dem Namen <code>ssh</code>. Um dies zu erreichen, können Sie beispielsweise ein neues Textfile erstellen und dieses <code>ssh</code> nennen. Nun entfernen Sie die Dateiendung .txt.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/activateSSH.png" alt="activateSSH" width="75% activate SSH">
</div>
<div class="title">Figure 8. <em>SSH aktivieren</em></div>
</div>
<div class="paragraph">
<p>Nun können Sie die Mini SD-Karte wieder in den Raspberry Pi einlegen und diesen mittels USB-Kabel an Ihren Computer anschliessen. Beim Startup von Raspbian untersucht das System den boot Folder und lädt Ihre neuen Einstellungen. Anschliessend können Sie PuTTY starten und mit der folgenden Konfiguration auf den Pi zugreifen.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/SSHputty.png" alt="SSHputty" width="65% SSH Zugriff">
</div>
<div class="title">Figure 9. <em>SSH Zugriff mit PuTTY</em></div>
</div>
<div class="paragraph">
<p>Im neuen Shell Fenster können Sie sich mit den Standard Credentials anmelden und den Raspberry Pi über die Konsole verwenden.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>User</strong>: pi</p>
</li>
<li>
<p><strong>Passwort</strong>: raspberry</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/puttyLogin.png" alt="puttyLogin" width="75% Login in PuTTY">
</div>
<div class="title">Figure 10. <em>Login in PuTTY</em></div>
</div>
</div>
<div class="sect3">
<h4 id="_zugriff_über_wifi">3.3.2. Zugriff über WiFi</h4>
<div class="paragraph">
<p>Die Verbindung zum Raspberry Pi via SSH funktioniert auch kabellos. Dafür muss sich Ihr Computer lediglich im gleichen Netzwerk befinden wie der Raspberry Pi. Zum Beispiel bei Ihnen Zuhause im WLAN oder über Ihren mobilen HotSpot. Damit der Pi auf das WLAN zugreifen kann, müssen Sie die SD-Karte erneut an Ihren Laptop anschliessen und eine neue Datei im boot Ordner erstellen. Das <code>wpa_supplicant.conf</code> File.</p>
</div>
<div class="paragraph">
<p>Wenn Sie bereits mit dem Pi über Kabel verbunden sind, können Sie die Datei auch direkt über die PuTTY Konsole erstellen. Mit dem unteren Befehl wird das File mit dem Text Editor <code>nano</code> erstellt.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo nano /etc/wpa_supplicant/wpa_supplicant.conf</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
country=CH

network={
    ssid="NETZWERK"
    psk="PASSWORT"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Bei <code>ssid</code> müssen Sie Ihren Netzwerknamen angeben und bei <code>psk</code> das Passwort. Sobald Sie die nötigen Einstellungen abgeschlossen haben, speichern Sie die getätigten Änderungen. Sofern nötig, schliessen Sie die SD-Karte wieder an den Raspberry Pi an.</p>
</div>
<div class="paragraph">
<p>Jetzt können Sie in PuTTY die IP-Adresse Ihres Raspberry Pi eingeben und sich somit direkt über das WLAN mit ihm verbinden.</p>
</div>
<div class="paragraph">
<p>Die IP Adresse Ihres Raspberry Pi können Sie über den Befehl <code>hostname -I</code> anzeigen lassen, sofern Sie bereits über Kabel mit dem Pi verbunden sind. Alternativ können Sie auch ein Tool auf Ihrem Laptop installieren, welches Ihr Netzwerk nach IPs scannt. Dafür haben wir den Advanced IP Scanner verwendet. Er ist einfach zu verwenden und seine Funktionalität ist selbsterklärend. Das Tool kann unter dem folgenden Link für Windows Rechner heruntergeladen werden:<br>
<a href="https://www.advanced-ip-scanner.com/de/" class="bare">https://www.advanced-ip-scanner.com/de/</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/advanced_ip_scanner.png" alt="advanced ip scanner" width="75% Advanced IP Scanner">
</div>
<div class="title">Figure 11. <em>Advanced IP Scanner</em></div>
</div>
</div>
<div class="sect3">
<h4 id="_zugriff_auf_ui_via_vnc_viewer">3.3.3. Zugriff auf UI via VNC Viewer</h4>
<div class="paragraph">
<p>Um ohne Monitor von den Vorzügen des grafischen User Interface von Raspbian profitieren zu können, kann man die VNC Funktionalitäten des Raspberry Pi verwenden. Dieses Feature muss allerdings zuerst in den Einstellungen des Raspberry Pi aktiviert werden.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Die Raspberry Pi Konfiguration mit dem Befehl <code>sudo raspi-config</code> öffnen.</p>
</li>
<li>
<p>Unter <code>Interfacing Options</code> zu <code>VNC</code> navigieren und die Auswahl bestätigen.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Der Pi ist nun für die Verwendung von VNC konfiguriert. Jetzt müssen Sie noch ein entsprechendes Tool auf Ihrem Rechner installieren. Wir haben mit der Software Real VNC Viewer gute Erfahrungen gemacht und würden Ihnen ebenfalls empfehlen, dieses Tool zu verwenden. Es untersützt eine breite Palette von Betriebssystemen, auf welchen es installiert werden kann. Das Tool kann über diese Webseite bezogen werden:<br>
<a href="https://www.realvnc.com/de/connect/download/viewer/" class="bare">https://www.realvnc.com/de/connect/download/viewer/</a></p>
</div>
<div class="paragraph">
<p>Beim Startup des Tools muss zuerst eine neue Verbindung angegeben werden. Diese wird dann für die künftige Verwendung abgespeichert.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/VNCViewer.png" alt="VNCViewer" width="70% VNC Viewer Zugriff auf Pi">
</div>
<div class="title">Figure 12. <em>VNC Viewer Zugriff auf Pi</em></div>
</div>
<div class="paragraph">
<p>Nach einem kurzen Verbindungsaufbau öffnet sich ein neues Fenster, welches einem den Remote Zugriff auf das User Interface des Raspberry Pi erlaubt.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/VNCViewerGUI.png" alt="VNCViewerGUI" width="70% VNC Viewer GUI von Raspbian">
</div>
<div class="title">Figure 13. <em>VNC Viewer GUI von Raspbian</em></div>
</div>
<div class="paragraph">
<p>Es kann gut sein, dass die Auflösung sowie die Grösse der Icons zu Beginn noch nicht optimal ist. Die Einstellungen können Sie wie folgend anpassen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Auflösung</strong>:<br>
<em>Preferences &#8594; Raspberry Pi Configuration &#8594; Display</em><br>
Hier können Sie unter "Set Resolution" die Auflösung verändern. Es kann sein, dass Sie zusätzlich die Option <em>"Underscan"</em> deaktivieren müssen, weil sie eventuell Ihre Einstellungen zur Auflösung überschreibt.</p>
</li>
<li>
<p><strong>Icon Grösse</strong>:<br>
<em>Preferences &#8594; Appearance Settings &#8594; System &#8594; Defaults</em><br>
Hier können Sie die Grösse der Icons gemäss Ihren Präferenzen ändern.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installation_von_zusätzlicher_software_auf_dem_pi">3.4. Installation von zusätzlicher Software auf dem Pi</h3>
<div class="paragraph">
<p>Bevor mit der Implementation von GPIO Projekten gestartet werden kann, muss noch weitere Software auf dem Raspberry Pi installiert werden. Für eine erfolgreiche Installation muss der Raspberry Pi über eine aktive Internetverbindung verfügen.</p>
</div>
<div class="sect3">
<h4 id="_java_2">3.4.1. Java</h4>
<div class="paragraph">
<p>Da wir die GPIO Pins mit Java kontrollieren möchten, brauchen wir auf dem Raspberry zwingen eine Java Version. Unsere Component Klasse nutzen Libraries, welche die Installation von Java 8 voraussetzen. Aus diesem Grund muss Java 8 auf dem Pi installiert sein. Neuere Java Version werden aktuell leider nicht unterstützt.</p>
</div>
<div class="paragraph">
<p>Java kann mittels <code>apt</code> auf dem Pi installiert werden. Dazu müssen die folgenden Kommandos auf der Konsole von Raspbian ausgeführt werden:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sudo apt update</code></p>
</li>
<li>
<p><code>sudo apt install openjdk-8-jdk</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sobald die installation abgeschlossen ist, kann mit dem Kommando <code>java –version</code> überprüft werden, ob die installation korrekt funktioniert hat. Das Kommando sollte den folgenden Output zeigen:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/java_version.png" alt="java version" width="75% java -version output">
</div>
<div class="title">Figure 14. <em>Output java -version</em></div>
</div>
<div class="paragraph">
<p>src: <a href="https://phoenixnap.com/kb/install-java-raspberry-pi" class="bare">https://phoenixnap.com/kb/install-java-raspberry-pi</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_gradle">3.4.2. Gradle</h4>
<div class="paragraph">
<p>Gradle wird für das Bauen des Codes benötigt. Mittels dem <code>wget</code> Befehl kann das Build Tool direkt auf der Herstellerseite heruntergeladen werden. Wir haben die Version 6.5.1 verwendet.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle als <code>.zip</code> herunterladen und im <code>tmp</code> Directory speichern:<br>
<code>wget <a href="https://services.gradle.org/distributions/gradle-6.5.1-bin.zip" class="bare">https://services.gradle.org/distributions/gradle-6.5.1-bin.zip</a> -P /tmp</code></p>
</li>
<li>
<p>Das heruntergeladene <code>.zip</code> File in den Folder <code>opt/gradle</code> entpacken:<br>
<code>sudo unzip -d /opt/gradle /tmp/gradle-*.zip</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Durch das Auflisten der entpackten Komponenten kann geführt werden, ob das Entpacken korrekt funktioniert hat.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ls /opt/gradle/gradle-6.5.1</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Das Kommando sollte den folgenden Output zeigen:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/gradle_folder_content.png" alt="gradle folder content" width="75% Gradle Folder Content">
</div>
<div class="title">Figure 15. <em>Gradle Ordner Inhalt</em></div>
</div>
<div class="paragraph">
<p>In einem nächsten Schritt müssen wir die PATH Variable für Gradle konfigurieren. Dazu müssen wir ein neues File auf dem Pi anlegen.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Neues File mit dem <code>nano</code> Editor öffnen:<br>
<code>sudo nano /etc/profile.d/gradle.sh</code></p>
</li>
<li>
<p>Im Editor folgenden Code einfügen:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>export GRADLE_HOME=/opt/gradle/gradle-6.5.1
export PATH=${GRADLE_HOME}/bin:${PATH}`</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>File mittels Ctrl + S speichern. Editor mit Ctrl + X verlassen.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Nun müssen wir das eben erzeugte Script mit dem <code>chmod</code> Befehl noch ausführbar machen.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sudo chmod +x /etc/profile.d/gradle.sh</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In einem letzten Schritt laden wir die Umgebungsvariablen neu.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>source /etc/profile.d/gradle.sh</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Die installation von Gradle ist nun abgeschlossen. Mit dem Befehl <code>gradle -v</code> können wir überprüfen, ob Gradel korrekt installiert wurde. Die Ausgabe des Kommandos sollte wie folgend aussehen:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/gradle_version.png" alt="gradle version" width="75% gradle -v output">
</div>
<div class="title">Figure 16. <em>Output gradle -v</em></div>
</div>
<div class="paragraph">
<p>src: <a href="https://linuxize.com/post/how-to-install-gradle-on-debian-9/" class="bare">https://linuxize.com/post/how-to-install-gradle-on-debian-9/</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_auf_dem_pi_bauen">4. Code auf dem Pi bauen</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Es ist möglich den Code in intelliJ auf dem eigenen Rechner zu schreiben und diesen dann auf den Pi zu deployen. Das hat den wesentlichen Vorteil, dass man nicht mit der langsamen Entwicklungsumgebung des Raspberry Pi arbeiten muss und auch nicht jede kleinste Änderung in git pushen muss, um es auf dem Pi mit der richtigen Hardware zu testen.</p>
</div>
<div class="sect2">
<h3 id="_remote_host_in_intellij">4.1. Remote Host in IntelliJ</h3>
<div class="paragraph">
<p>Um Ihren Raspberry Pi als Remote Host in IntelliJ einzurichten, müssen Sie zuerst in der Menüleiste die folgendenden Menüpunkte wählen:  <em>"Tools" &#8594; "Deployment" &#8594; "Browse Remote Host"</em></p>
</div>
<div class="paragraph">
<p>Jetzt erscheint ein neues Menü auf der rechten Seite, wo sich auch normalerweise  die gradle und Datenbank Einstellungen befinden.</p>
</div>
<div class="paragraph">
<p>Klicken Sie in diesem Menü auf die 3 Punkte, um einen neuen Server zu erstellen. Der Name spielt hierbei keine Rolle, aber der Typ sollte SFTP sein. Bestätigen Sie dann ihre Eingabe.</p>
</div>
<div class="paragraph">
<p>Nun können Sie die Einstellung für das Raspberry Pi im Deployment Fenster angeben:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Geben Sie zuerst die IP-Adresse des Raspberry Pis an</p>
</li>
<li>
<p>Hier können Sie die Connection mit dem Usernamen und dem Passwort einmal ausprobieren, bevor Sie es hinzufügen.</p>
</li>
<li>
<p>Nach dem Connection-Test können Sie auf das kleine Ordner Symbol klicken, um auf die Ordner Struktur des Raspberry Pis zu zugreifen. Wählen Sie hier den Ort, an dem Alle Files des Projekts hinkopiert werden sollen.</p>
</li>
<li>
<p>Sie können mehrere Server hinzufügen, für die einfache Verwendung in verschiedenen Netzwerken</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/RemoteHost3.png" alt="RemoteHost3" width="75% remote host server settings">
</div>
<div class="title">Figure 17. <em>Remote Host Server Einstellungen</em></div>
</div>
<div class="paragraph">
<p>Jetzt können Sie jederzeit alle Dateien oder einzelne ausgewählte Dateien via Remote Host Menü auf den Raspberry Pi übertragen.</p>
</div>
<div class="paragraph">
<p>Auf dem Pi selbst müssen Sie dann nur noch ihr Projekt bauen und ausführen. Währen der Entwicklung geniessen Sie allerdings alle Vorzüge der IDE auf ihrem Rechner.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/RemoteHost4.png" alt="RemoteHost4" width="75% update remote host server">
</div>
<div class="title">Figure 18. <em>Update Remote Host</em></div>
</div>
</div>
<div class="sect2">
<h3 id="_code_mit_gradle_bauen">4.2. Code mit Gradle bauen</h3>
<div class="paragraph">
<p>Nachdem der Code via Remote Deployment auf den Rasbperry Pi gespielt wurde, müssen wir diesen noch kompilieren und als <code>.jar</code> ablegen. Dies ist die Aufgabe von Gradle. Für die Ausführung des Gradle Tasks navigieren Sie bitte in den Root Folder ihres Projekts. Dort kann das Projekt dann mit dem folgenden Befehl gebaut werden:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>gradle jar</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sofern die Kompilierung fehlerfrei war, sollten Sie den folgenden Output erhalten:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/gradle_jar.png" alt="gradle jar" width="75% gradle jar output">
</div>
<div class="title">Figure 19. <em>Output gradle jar</em></div>
</div>
<div class="paragraph">
<p>Gradle hat nun ein <code>.jar</code> File generiert und im Folder <code>build/libs</code> ihres Projektes abgelegt. Das <code>.jar</code> File kann nun gestartet werden.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java -jar build/libs/YOUR_PROJECT_NAME_AND_VERSION.jar</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sofern Ihr Projekt den seriellen Bus des Raspberry Pis verwendet, müssen Sie das <code>.jar</code> als Administrator (<code>sudo</code>) starten.</p>
</div>
<div class="paragraph">
<p>Der Befehl <code>gradle jar</code> setzt voraus, dass ihr <code>build.gradle</code> File einen Task mit dem Namen <code>jar</code> enthätl. Dieser Task sollte den folgenden Code enthalten:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">jar {
    manifest {
        attributes "Main-Class": "Main.Class.Path"
    }
    from {
        configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_optional_remote_debugging">4.3. Optional: Remote Debugging</h3>
<div class="paragraph">
<p>Es ist auch möglich den Code vom eigenen Rechner aus mit IntelliJ auf dem Raspberry Pi auszuführen und diesen auf dem eigenen Rechner zu debuggen. Diese Funktionalität kann sehr hilfreich sein, wenn man mit schwierigen Bugs zu tun hat, aber birgt auch Schwierigkeiten und funktioniert auch nicht immer ideal, deshalb wurde dieser Bereich als optional deklariert.</p>
</div>
<div class="paragraph">
<p>Wenn Sie ein schweres Problem haben und sich das Debugging aber erleichtern wollen, dann ist es empfehlenswert diese Funktionalität auszuprobieren.</p>
</div>
<div class="paragraph">
<p><strong>Setup</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Downloaden Sie das folgende Plugin von Jetbrains: <br>
<a href="https://plugins.jetbrains.com/plugin/7738-embedded-linux-jvm-debugger-raspberry-pi-beaglebone-black-intel-galileo-ii-and-several-other-iot-devices-">Embedded Linux JVM Debugger</a></p>
</li>
<li>
<p>Fügen Sie eine Run/ Debug Configuration hinzu vom Typ Embedded Linux JVM, wie im Bild weiter unten ersichtlich. Ersetzten Sie einfach die IP-Addresse und die Projektinformationen mit denen von Ihnen.<br></p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/installation/RemoteDebugging.png" alt="RemoteDebugging" width="75% Remote Debuggging Configuration">
</div>
<div class="title">Figure 20. <em>Embedded JVM Configuration</em></div>
</div>
<div class="paragraph">
<p>Für  weitere Informationen zum Remote Debugging mit IntelliJ auf dem Raspberry Pi können Sie den folgenden Artikel studieren:<br>
<a href="https://medium.com/@menchukanton/setup-intellij-idea-for-remote-debugging-java-code-on-a-raspberry-pi-6e9df09dfb95">Remote debugging java code on a Raspberry Pi</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_beispiele">5. Beispiele</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In diesem Kapitel finden Sie für eine Vielzahl an gängigen Sensoren und Aktuatoren Code Beispiele sowie Beispiele zur Verkabelung. Für ein vollständiges Verständnis der Code Beispiele sind gewisse Vorkenntnisse von Nöten. Wir haben die Beispiele deshalb in Levels eingeteilt, an welchen Sie den Grad an nötigen Vorkenntnissen einfach erkennen können.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Level 1: Basic</strong></p>
<div class="ulist">
<ul>
<li>
<p>Variablen und Berechnungen: primitive Datentypen, Wertebereiche und deren Auswirkung beim Rechnen.</p>
</li>
<li>
<p>Methoden und Parameter: Deklaration, Aufruf, Signatur, Argumente und Rückgabewerte.</p>
</li>
<li>
<p>Kontrollstrukturen: Schleifen und Fallunterscheidungen.</p>
</li>
<li>
<p>Grundlagen Klassen, Objekte und Vererbung: Deklaration und Instanziierung von Klassen, Überladen und Überschreiben von Methoden, Vererbung, Polymorphie.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Level 2: Intermediate</strong></p>
<div class="ulist">
<ul>
<li>
<p>Verwendung grundlegender Datenstrukturen (List, Map, Set) und Iteratoren.</p>
</li>
<li>
<p>Generics und ihre Besonderheiten in Java.</p>
</li>
<li>
<p>Event Handling.</p>
</li>
<li>
<p>Collection-Streams und Lambda-Ausdrücke.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Level 3: Advanced</strong></p>
<div class="ulist">
<ul>
<li>
<p>Nebenläufigkeit mit Threads.</p>
</li>
<li>
<p>Strukturierung von Applikationen.</p>
</li>
<li>
<p>Daten-Persistenz (File-Handling, Serialisierung).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_led">5.1. LED</h3>
<div class="paragraph">
<p>Leuchtdioden emmitieren Licht, sofern Strom duch sie fliesst. Wie bei allen Dioden lassen LEDs nur eine Flussrichtiung zu. Mit unserer LedComponent lässt sich der Status der LED kontrollieren. Über PWM kann zusätzlich die Helligkeit der LED eingestellt werden.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://upload.wikimedia.org/wikipedia/commons/9/9e/Verschiedene_LEDs.jpg"><img src="./assets/images/led.jpg" alt="led" width="75% LED"></a>
</div>
<div class="title">Figure 21. LED</div>
</div>
<div class="sect3">
<h4 id="_verkabelung">5.1.1. Verkabelung</h4>
<div class="paragraph">
<p>Für die Verkabelung wird folgende Hardware benötigt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>2x Kabel</p>
</li>
<li>
<p>1x LED</p>
</li>
<li>
<p>1x 220Ω Wiederstand</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/fritzing/blink_led.png" alt="blink led" width="75% LED Wiring">
</div>
<div class="title">Figure 22. LED Verkabelung</div>
</div>
</div>
<div class="sect3">
<h4 id="_api">5.1.2. API</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. LED - Konstruktoren</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Konstruktor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LedComponent(com.pi4j.io.gpio.GpioPinDigitalOutput pin)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor for directly controlling digital LEDs without PWM.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LedComponent(com.pi4j.io.gpio.GpioPinPwmOutput pwmPin)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor for controlling LEDs connected to pins with hard- or software PWM. This constructor allows controlling the brightness of the LED.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LedComponent(GroveAdapter adapter)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor for controlling Grove LEDs.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. LED - Funktionen</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rückgabetyp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Funktion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setBrightness(int brightness)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the brightness of a LED through PWM. Method may only be used if a PWM pin is provided.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">turnLedOff()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Turns the LED off. If a PWM pin was provided in the constructor, the brightness is set to 0%.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">turnLedOn()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Turns the LED on. If a PWM pin was provided in the constructor, the brightness is set to 100%.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_anwendungsbeispiel">5.1.3. Anwendungsbeispiel</h4>
<div class="paragraph">
<p>Die blinkende LED ist das "Hello World"-Äquivalent der GPIO Programmierung. Unser Beispiel lässt eine LED 2x blinken. Anschliessend wird die Helligkeit der LED schrittweise von 0% auf 100% inkrementiert. Nach dem Erreichen der maximalen Helligkeit dekrementieren die Lichtstärke wieder auf 0%. Das Dimmen der LED ist durch Pulse Width Modulation möglich. Diese Funktionalität wird durch die Übergabe eines <code>GpioPinPwmOutput</code> Pin an den Konstruktor der LedComponent ermöglicht.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @Override public void execute() throws Exception {
        GpioFactory.setDefaultProvider(new RaspiGpioProvider(RaspiPinNumberingScheme.BROADCOM_PIN_NUMBERING));
        final GpioController gpio = GpioFactory.getInstance();

        Console console = new Console();
        console.promptForExit();

        GpioPinPwmOutput pwmPin = gpio.provisionSoftPwmOutputPin(RaspiBcmPin.GPIO_02);
        LedComponent led = new LedComponent(pwmPin);

        while (console.isRunning()) {
            led.turnLedOff();
            Thread.sleep(250);
            led.turnLedOn();
            Thread.sleep(250);
            led.turnLedOff();
            Thread.sleep(250);
            led.turnLedOn();
            Thread.sleep(250);

            for (int i = 0; i &lt;= 100; i++) {
                led.setBrightness(i);
                Thread.sleep(15);
            }

            for (int i = 100; i &gt;= 0; i--) {
                led.setBrightness(i);
                Thread.sleep(15);
            }

        }

        gpio.shutdown();
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_button">5.2. Button</h3>
<div class="paragraph">
<p>Buttons sind simple Sensoren. Der Sensor kann zwei Zustände haben. Entweder lässt er Strom fliessen oder er unterbricht die Leitung. Richtig verkabelt kann der jeweilige Wert an einem digitalen Pin des Raspberry Pi gelesen werden.</p>
</div>
<div class="paragraph">
<p>Unsere Component-Klasse unterstützt sowohl Grove Buttons als auch Standard Buttons. Andere einfache digitale Sensoren mit zwei zuständen werden ebenfalls unterstützt wie Beispielsweise Grove Touch Sensoren.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://cdn.antratek.nl/media/product/03c/mini-push-button-switch-com-00097-1b3.jpg"><img src="./assets/images/push_button.png" alt="push button" width="75% Push Button"></a>
</div>
<div class="title">Figure 23. Button</div>
</div>
<div class="sect3">
<h4 id="_verkabelung_2">5.2.1. Verkabelung</h4>
<div class="paragraph">
<p>Für die Verkabelung wird folgende Hardware benötigt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>4x Kabel</p>
</li>
<li>
<p>1x Button</p>
</li>
<li>
<p>1x 1kΩ Wiederstand</p>
</li>
<li>
<p>1x 10kΩ Wiederstand</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/fritzing/button_click.png" alt="button click" width="75% Button Wiring">
</div>
<div class="title">Figure 24. Button Verkabelung</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_2">5.2.2. API</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Button - Konstruktoren</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Konstruktor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ButtonComponent(com.pi4j.io.gpio.GpioPinDigitalInput pin)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor for GPIO pins without value reversion.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ButtonComponent(com.pi4j.io.gpio.GpioPinDigitalInput pin, boolean reverse)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor for GPIO pins. User can set if the buttons value should be reversed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ButtonComponent(GroveAdapter adapter)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor for digital grove devices without value reversion.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ButtonComponent(GroveAdapter adapter, boolean reverse)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor for digital grove devices. User can set if the buttons value should be reversed.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Button - Funktionen</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rückgabetyp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Funktion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">isPressed()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns if the button is pressed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">isReleased()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns if the button is released.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setReverse(boolean reverse)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This function allows the user to change the buttons behaviour.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_anwendungsbeispiel_2">5.2.3. Anwendungsbeispiel</h4>
<div class="paragraph">
<p>Das folgende Code Beispiel loggt den Zustand des Buttons bei jedem Zustandswechsel. Zwischen den einzelnen Messungen wird jeweils eine Pause von 10 Millisekunden eingelegt. Dies hat zwei Gründe. Einerseits gönnen wir dem Prozessor des Raspberry Pi etwas Pausenzeit, andererseits eliminieren wir Messfehler, welche durch die Vibration des betätigenden Fingers ausgelöst werden.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @Override public void execute() throws Exception {
        GpioFactory.setDefaultProvider(new RaspiGpioProvider(RaspiPinNumberingScheme.BROADCOM_PIN_NUMBERING));
        final GpioController gpio = GpioFactory.getInstance();

        Console console = new Console();
        console.promptForExit();

        GpioPinDigitalInput pin = gpio.provisionDigitalInputPin(RaspiBcmPin.GPIO_17);
        ButtonComponent button = new ButtonComponent(pin);

        boolean lastStatePressed = false;

        while (console.isRunning()) {
            if (button.isPressed() &amp;&amp; !lastStatePressed) {
                console.println("button is pressed");
                lastStatePressed = true;
            } else if (button.isReleased() &amp;&amp; lastStatePressed) {
                console.println("button is released");
                lastStatePressed = false;
            }

            // Avoid vibration error
            Thread.sleep(10);
        }

        gpio.shutdown();
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_buzzer">5.3. Buzzer</h3>
<div class="paragraph">
<p>Ein Buzzer ist eine Art primitiver Speaker. Er wandelt ein elektrisches Signal in einen Ton um. Je nach Frequenz des Signals ändert sich der Ton, welche wiedergegeben wird.</p>
</div>
<div class="paragraph">
<p>Die Hilfsklasse <code>Notes</code> stellt eine Vielzahl von Tönen über mehrere Oktaven zur Verfügung. Jedes Enum Attribut verfügt über einen Integer, welcher der Frequenz des Tons entspricht.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.geekering.com/wp-content/uploads/2020/01/buzzer_passivo.jpg"><img src="./assets/images/buzzer.jpg" alt="buzzer" width="30% Buzzer"></a>
</div>
<div class="title">Figure 25. Buzzer</div>
</div>
<div class="sect3">
<h4 id="_verkabelung_3">5.3.1. Verkabelung</h4>
<div class="paragraph">
<p>Für die Verkabelung wird folgende Hardware benötigt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>2x Kabel</p>
</li>
<li>
<p>1x Buzzer</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/fritzing/buzzer.png" alt="buzzer" width="50% Buzzer Fritzing">
</div>
<div class="title">Figure 26. Buzzer Verkabelung</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_3">5.3.2. API</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Buzzer - Konstruktoren</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Konstruktor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BuzzerComponent(com.pi4j.io.gpio.GpioPinPwmOutput pin)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor for GPIO buzzer usage.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BuzzerComponent(GroveAdapter groveAdapter)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor for Grove buzzer usage.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Buzzer - Funktionen</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rückgabetyp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Funktion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">playTone(int frequency)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Plays a tone with a specific frequency.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">playTone(int frequency, int duration)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Plays a tone at a frequency for a specified duration in milliseconds.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stop()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pauses forever.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stop(int duration)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pauses for a specified amount of milliseconds.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_anwendungsbeispiel_3">5.3.3. Anwendungsbeispiel</h4>
<div class="paragraph">
<p>Unser Code Beispiel spielt den Imperial March komponiert von John Williams auf dem Buzzer. Der Buzzer wird am GPIO PWM Pin 12 angeschlossen. Im Array <code>notes</code> sind die zu spielenden Noten abgespeichert. Das Array <code>beats</code> speichert die Anzahl der Beats, über welche der Ton an der aktuellen stelle gespielt werden soll. In der Variable <code>tempo</code> wird gespeichert, wie lange ein Beat geht. Im unserem Fall 103 Millisekunden.</p>
</div>
<div class="paragraph">
<p>In einer for-Schleife wird nun durch die einzelnen <code>notes</code> iteriert. Jeder Ton wird entsprechend seiner Anzahl Beats abgespielt.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @Override public void execute() throws Exception {
        GpioFactory.setDefaultProvider(new RaspiGpioProvider(RaspiPinNumberingScheme.BROADCOM_PIN_NUMBERING));
        final GpioController gpio = GpioFactory.getInstance();

        Console console = new Console();
        console.promptForExit();

        GpioPinPwmOutput pwm = gpio.provisionPwmOutputPin(RaspiBcmPin.GPIO_12);
        BuzzerComponent buzzer = new BuzzerComponent(pwm);

        Note notes[] = { Note.G4, Note.G4, Note.G4, Note.DS4, Note.AS4, Note.G4, Note.DS4, Note.AS4, Note.G4, Note.D5,
                Note.D5, Note.D5, Note.DS5, Note.AS4, Note.FS4, Note.DS4, Note.AS4, Note.G4, Note.G5, Note.G4, Note.G4,
                Note.G5, Note.FS5, Note.F5, Note.E5, Note.DS5, Note.E5, Note.PAUSE, Note.G4, Note.PAUSE, Note.CS5,
                Note.C5, Note.B4, Note.AS4, Note.A4, Note.AS4, Note.PAUSE, Note.DS4, Note.PAUSE, Note.FS4, Note.DS4,
                Note.AS4, Note.G4, Note.DS4, Note.AS4, Note.G4 };
        int beats[] = { 8, 8, 8, 6, 2, 8, 6, 2, 16, 8, 8, 8, 6, 2, 8, 6, 2, 16, 8, 6, 2, 8, 6, 2, 2, 2, 2, 6, 2, 2, 8,
                6, 2, 2, 2, 2, 6, 2, 2, 9, 6, 2, 8, 6, 2, 16 };
        int tempo = 103;

        while (console.isRunning()) {
            for (int i = 0; i &lt; notes.length; i++) {
                buzzer.playTone(notes[i].getFrequency(), tempo * beats[i]);
            }

            buzzer.stop();
            Thread.sleep(3000);

        }

        buzzer.stop();
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lcd_i2c">5.4. LCD I2C</h3>
<div class="sect3">
<h4 id="_verkabelung_4">5.4.1. Verkabelung</h4>
<div class="paragraph">
<p>Für die Verkabelung wird folgende Hardware benötigt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>4x Kabel</p>
</li>
<li>
<p>1x LCD1602 I2C Modul mit PCF8574 I2C extender</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/fritzing/LCDI2C.png" alt="LCDI2C" width="75% I2C Wiring">
</div>
<div class="title">Figure 27. LCD I2C Modul Verkabelung</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_4">5.4.2. API</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. I2C LCD - Konstruktoren</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Konstruktor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">I2CLCDComponent(int address, int busNumber)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard Constructor that needs address and the busnumber to initialise.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">I2CLCDComponent(com.pi4j.io.i2c.I2CDevice device)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor that needs I2C information in the pi4j I2CDevice object.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. I2C LCD - Funktionen</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rückgabetyp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Funktion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">init()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sends initialisation commands to display.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">clearText()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clears the lcd text.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">displayText​(String text)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Displays a text on the first line of the display. If it&#8217;s larger than 16 characters then it will jump over to the second line. The excess characters (greater than 32) are not shown on the display.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">displayText​(String text, int line)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Writes string to the lcd display on a specific line. Excess characters (greater than 16) are not shown on the line.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">displayText​(String text, int line, int pos, boolean jumpToNextLine)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Displays the string with an additional position. There are 16 fields on one LCD1602 line. The position gives the number of fields that should be empty before the text. Excess characters (greater than 16-position) on the line will not be shown.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">displayScrollText​(String text, int line, int delay, boolean jumpToNextLine, boolean startAgain)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shows text on display and scrolls it with a delay.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">displayBounceText​(String text, int line, int delay, boolean jumpToNextLine, boolean startAgain)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Displays the text and scrolls to the sides, but bounces back. This only works for short texts, otherwise it would be unreadable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">writeCharacter​(byte charvalue)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write a character to lcd.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setBacklightState​(boolean state)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Define backlight on / off(lcd.backlight(1) off = lcd.backlight(0).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_anwendungsbeispiel_4">5.4.3. Anwendungsbeispiel</h4>
<div class="paragraph">
<p>In diesem Code Beispiel wird der Titel des Projekts in der ersten Zeile angezeigt und die Uhrzeit in der Zweiten. Die Uhrzeit wird im Sekundentakt aktualisiert.<br>
<strong>Vorkenntnisse: Basic</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void execute() {
        Console console = new Console();
        try {
            //find the address and the bus with the following command on the pi
            //sudo i2cdetect -y 1
            I2CLCDComponent lcd = new I2CLCDComponent(0x27, I2CBus.BUS_1);
            lcd.init();

            Scanner scanner = new Scanner(System.in);
            console.println("Please enter a text to be displayed above the system time");
            String text = scanner.nextLine();

            lcd.displayText(text, 1, 0, false);

            SimpleDateFormat formatter = new SimpleDateFormat("HH:mm:ss");
            while (true) {
                lcd.displayText(formatter.format((new Date())), 2, 4, false);
                Thread.sleep(1000);
            }
        } catch (Exception ex) {
            console.println(ex.toString());
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_potentiometer">5.5. Potentiometer</h3>
<div class="paragraph">
<p>Ein Potentiometer ist eine Art dynamischer Wiederstand, welcher durch das Drehen oder Verschieben eines Reglers vergrössert oder verkleinert werden kann. Der Grove Potentiometer gibt uns je nach eingestelltem Wiederstand einen Wert zwischen 0 und 1'000 zurück. Mit einem Potentiometer können wir also Werte einstellen, mit welchen wir dann einen Aktuator kontrollieren können. Zum Beispiel könnten wir mit einem Potentiometer die Helligkeit einer Leuchtdiode steuern.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.seeedstudio.com/Grove-Rotary-Angle-Sensor.html"><img src="./assets/images/Grove_Rotary_Angle_Sensor.jpg" alt="Grove Rotary Angle Sensor" width="75% Grove Rotary Angle Sensor"></a>
</div>
<div class="title">Figure 28. Grove Potentiometer</div>
</div>
<div class="sect3">
<h4 id="_verkabelung_5">5.5.1. Verkabelung</h4>
<div class="paragraph">
<p>Für die Verkabelung wird folgende Hardware benötigt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1x Grove Potentiometer mit Grove Adapter Kabel</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://wiki.seeedstudio.com/Grove-Rotary_Angle_Sensor/"><img src="./assets/images/fritzing/Grove_Base_Hat_Rotary_Angel_Sensor.jpg" alt="Grove Base Hat Rotary Angel Sensor" width="75% Grove Rotary Angle Sensor Fritzing"></a>
</div>
<div class="title">Figure 29. Grove Potentiometer Verkabelung</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_5">5.5.2. API</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Potentiometer - Konstruktoren</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Konstruktor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PotentiometerComponent(GroveAdapter groveAdapter)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor of the PotentiometerComponent with Grove adapter.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Potentiometer - Funktionen</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rückgabetyp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Funktion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">getValue()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get the current value from the potentiometer.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_anwendungsbeispiel_5">5.5.3. Anwendungsbeispiel</h4>
<div class="paragraph">
<p>Das Code Beispiel erzeugt ein neues <code>PotentiometerComponent</code>, welches am Grove Base Hat am analogen Adapter A0 anliegt. Mit der <code>setRange()</code> Funktion wird sichergestellt, dass die zurückgegebenen Werte zwischen 0 und 100 liegen. Der aktuelle Wert wird alle 500 Millisekunden geloggt.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @Override public void execute() throws Exception {
        Console console = new Console();
        console.promptForExit();

        PotentiometerComponent potentiometer = new PotentiometerComponent(GroveAdapter.A0);
        potentiometer.setRange(0, 100);

        while (console.isRunning()) {
            Thread.sleep(500);
            console.println(potentiometer.getValue());
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_grove_rfid_reader">5.6. Grove RFID Reader</h3>
<div class="paragraph">
<p>Der Grove RFID Reader ist ein 125KHz RFID Reader, welches uem4100 RFID Karteninformationen seriell lesen kann. Die maximale Distanz zum Lesen beträgt 70mm. Die RFID Reader benötigt eine Spannung von 5 Volt, weshalb es nicht mit dem Grove Hat kompatibel ist, da dieser nur 3.3 Volt liefert. Es ist jedoch möglich es mit Kabeln direkt an den Pi zu verbinden, wie bei der Grove Serial Camera.</p>
</div>
<div class="sect3">
<h4 id="_verkabelung_6">5.6.1. Verkabelung</h4>
<div class="paragraph">
<p>Für die Verkabelung wird folgende Hardware benötigt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1x Grove RFID Reader mit Grove Adapter Kabel</p>
</li>
<li>
<p>4x Kabel</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/fritzing/grove_rfid_reader.png" alt="grove rfid reader" width="75% Grove RFID Reader Fritzing">
</div>
<div class="title">Figure 30. Grove RFID Reader Verkabelung</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_6">5.6.2. API</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. RFID Reader - Konstruktoren</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Konstruktor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RFIDReaderComponent​()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard constructor of the RFID Reader.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. RFID - Funktionen</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rückgabetyp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Funktion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">addListener​(com.pi4j.io.serial.SerialDataEventListener&#8230;&#8203; listener)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Adds Listeners for when the device receives data.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_anwendungsbeispiel_6">5.6.3. Anwendungsbeispiel</h4>
<div class="paragraph">
<p>In diesem Code Beispiel wird der Grove RFID Reader getestet. Das serielle Gerät wird initialisiert und ein Listener wird hinzugefügt, der die <code>dataReceived()</code> Methode des <code>SerialDataEventListener</code> überschreibt. Diese Methode wird immer ausgeführt, wenn der RFID Reader Daten durch einen RFID Tag erhält.<br>
<strong>Vorkenntnisse: Intermediate</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">        RFIDReaderComponent rfidReaderComponent = new RFIDReaderComponent();
        // create and register the serial data listener
        rfidReaderComponent.addListener(new SerialDataEventListener() {
            @Override
            public void dataReceived(SerialDataEvent event) {
                // print out the data received to the console
                try {
                    console.println("[HEX DATA]   " + event.getHexByteString());
                    console.println("[ASCII DATA] " + event.getAsciiString());
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        });</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ultrasonic_ranger">5.7. Ultrasonic Ranger</h3>
<div class="paragraph">
<p>Der Grove Ultrasonic Ranger ist ein Grove Modul, welches an eines der digitalen Adapter des Grove Hats angeschlossen werden kann. Der Ultrasonic Ranger misst die Distanz zwischen dem Sensor und einem Ziel indem die Zeit zwischen der Emission und der Rezeption einer Ultraschallwelle gemessen wird. Es kann Distanzen von bis zu 2m lesen.</p>
</div>
<div class="paragraph">
<p><strong>Formel zur Distanzmessung: 0.5 * T * C</strong><br></p>
</div>
<div class="ulist">
<ul>
<li>
<p>T ist die Zeit zwischen Emission und Rezeption der Ultraschallwelle (Davon die Hälfte, da nur der einfache Weg verwendet wird)</p>
</li>
<li>
<p>C ist die Ultraschallwellengeschwindigkeit</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_verkabelung_7">5.7.1. Verkabelung</h4>
<div class="paragraph">
<p>Für die Verkabelung wird folgende Hardware benötigt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1x Grove Ultrasonic Ranger</p>
</li>
<li>
<p>1x Grove Adapter Kabel</p>
</li>
<li>
<p>1x Grove Hat</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://wiki.seeedstudio.com/Grove-Ultrasonic_Ranger/"><img src="./assets/images/Grove_Ultrasonic_Ranger.jpg" alt="Grove Ultrasonic Ranger" width="75% RaspiCam Wiring"></a>
</div>
<div class="title">Figure 31. Ultrasonic Ranger Verkabelung</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_7">5.7.2. API</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Ultrasonic Ranger - Konstruktoren</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Konstruktor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UltraSonicRangerComponent​(GroveAdapter groveAdapter)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard Constructor for the Ultra Sonic Ranger that only needs grove hat connection information.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. Ultrasonic Ranger - Funktionen</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rückgabetyp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Funktion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">measureInCentimeter()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Measures the distance between the device and an object in cm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">measureInInches()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Measures the distance between the device and an object in inches.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_anwendungsbeispiel_7">5.7.3. Anwendungsbeispiel</h4>
<div class="paragraph">
<p>In diesem Beispiel wird der Grove Ultrasonic Ranger an den D5 Adapter des Grove Hats angeschlossen und es wird sekündlich die Distanz gemessen zwischen dem Device und einem Ziel.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">            UltraSonicRangerComponent ultraSonicRangerComponent = new UltraSonicRangerComponent(GroveAdapter.D5);

            //Shows the measured distance every second
            while (true) {
                long distance = ultraSonicRangerComponent.measureInCentimeter();
                console.println(distance);
                Thread.sleep(1000);
            }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dc_motor">5.8. DC Motor</h3>
<div class="paragraph">
<p>Gleichstrommotoren arbeiten, wie der Name schon verrät, mit Gleichstrom. Da der Raspberry Pi Gleichstrom mit 3.3 Volt sowie 5.0 Volt zur Verfügung stellt, können die Motoren direkt an den Stromkreis des Pi angeschlossen werden. Alternativ kann auch eine stärkere, externe Spannungsquelle verwendet werden. Dabei gilt aber zu beachten, dass der Motor nicht überlastet wird.</p>
</div>
<div class="paragraph">
<p>Um einen DC Motor zu kontrollieren, benötigt man einen Motor Treiber. Wir haben dazu den Chip L293D verwendet. Natürlich kann auch ein anderer Treiber verwendet werden.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Das Pinout des L293D findet ihr unter folgendem Link oder in diesem Dokument unter Zusatzinformationen.: <a href="https://components101.com/l293d-pinout-features-datasheet" class="bare">https://components101.com/l293d-pinout-features-datasheet</a></p>
</li>
<li>
<p>Dieses Youtube Video von Gaven MacDonald zeit auf, wie ein DC Motor über GPIO Pins gesteuert werden kann. Ab der Minute 2 wird genauer auf den Treiber L293D eingegangen. <a href="https://www.youtube.com/watch?v=W7cV9_W12sM" class="bare">https://www.youtube.com/watch?v=W7cV9_W12sM</a></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://elektro.turanis.de/html/prj147/index.html"><img src="./assets/images/motor_and_driver.png" alt="motor and driver" width="75% DC Motor and Driver"></a>
</div>
<div class="title">Figure 32. Motor und Treiber</div>
</div>
<div class="sect3">
<h4 id="_verkabelung_8">5.8.1. Verkabelung</h4>
<div class="paragraph">
<p>Für die Verkabelung wird folgende Hardware benötigt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1x DC Motor</p>
</li>
<li>
<p>1x L93D Treiber</p>
</li>
<li>
<p>10x Kabel</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/fritzing/motor.png" alt="motor" width="75% DC Motor Fritzing">
</div>
<div class="title">Figure 33. DC Motor Verkabelung</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_8">5.8.2. API</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. Motor - Konstruktoren</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Konstruktor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MotorComponent(com.pi4j.io.gpio.GpioPinDigitalOutput forwards, com.pi4j.io.gpio.GpioPinDigitalOutput backwards)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor of the MotorComponent. This constructor allows controlling the motors direction using digital output pins.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MotorComponent(com.pi4j.io.gpio.GpioPinPwmOutput forwards, com.pi4j.io.gpio.GpioPinPwmOutput backwards)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor of the MotorComponent. This constructor allows controlling the motors direction and speed using hardware or software pwm output pins.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. Motor - Funktionen</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rückgabetyp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Funktion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">moveBackwards()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Runs the motor run backwards at full speed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">moveBackwards(int power)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Runs the motor backwards at a specific speed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">moveForwards()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Runs the motor run forwards at full speed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">moveForwards(int power)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Runs the motor forwards at a specific speed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stop()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stops the motor.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_anwendungsbeispiel_8">5.8.3. Anwendungsbeispiel</h4>
<div class="paragraph">
<p>Das Code Beispiel erzeugt ein neues <code>MotorComponent</code>. Bei der Erstellung wird jener Konstruktor benutzt, welcher PWM Pins unterstützt. Dieser erlaubt die Drosselung der Drehzahldes Motors.</p>
</div>
<div class="paragraph">
<p>In einer While-Schlaufe wird die Drehzahl des vorwärts drehenden Motors schrittweise um 10% erhöht. Nachdem 100% Leistung erreicht wurde, stoppt der Motor für 5 Sekunden. Anschliessend wird die Drehrichtung des Motors umgekehrt. Der Motor dreht nun rückwärts und die Drehzahl wird wiederum schrittweise um je 10% inkrementiert.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @Override public void execute() throws Exception {
        GpioProvider provider = new RaspiGpioProvider(RaspiPinNumberingScheme.BROADCOM_PIN_NUMBERING);
        GpioFactory.setDefaultProvider(provider);
        final GpioController gpio = GpioFactory.getInstance();

        Console console = new Console();
        console.promptForExit();

        GpioPinPwmOutput pwmForwards = gpio.provisionPwmOutputPin(RaspiBcmPin.GPIO_12);
        GpioPinPwmOutput pwmBackwards = gpio.provisionPwmOutputPin(RaspiBcmPin.GPIO_13);
        MotorComponent pwmMotor = new MotorComponent(pwmForwards, pwmBackwards);

        while (console.isRunning()) {
            for (int i = 0; i &lt;= 100; i = i + 10) {
                pwmMotor.moveForwards(i);
                Thread.sleep(1000);
            }

            pwmMotor.stop();
            Thread.sleep(5000);

            for (int i = 0; i &lt;= 100; i = i + 10) {
                pwmMotor.moveBackwards(i);
                Thread.sleep(1000);
            }

            pwmMotor.stop();
            Thread.sleep(5000);
        }

        gpio.shutdown();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_stepper_motor">5.9. Stepper Motor</h3>
<div class="paragraph">
<p>Der Stepper Motor oder Schrittmotor rotiert die in seiner Mitte liegende Welle in Schritten. Die Welle eines Schrittmotors dreht sich im Vergleich zu jener eines Gleichstrommotors sehr langsam. Dafür kann der Schrittmotor sehr genau gesteuert werden. Je nach eingestelltem Modus variiert die Anzahl der Schritte, welche für eine gesamte Drehung benötigt werden. Der Modus beeinflusst auch die Kraft, welcher der Motor hat und hat Zusammenhang mit dem resultierenden Energieverbrauch des Motors.</p>
</div>
<div class="paragraph">
<p>In der unten abgebildeten Tabelle beziehen wir uns auf den weit verbreiteten Schrittmotor 28BYJ-48. Eine Drehung des Zylinders innerhalb des Motors resultiert in einer Drehung der Welle um 11.25°. Für eine Komplette Drehung werden also 360° / 11.25° = 32 Schritte benötigt. Ein Getriebe innerhalb des Motors reduziert einen einzelnen Schritt in weitere 64 Steps. Unter Verwendung des Full oder Dual Stepping bedeutet ein einzelner Step also eine Drehung um 360° / (32 * 64) = 0.17578125°. Bei Half Stepping verdoppelt sich die Anzahl der möglichen Schritte, was eine Drehgenauigkeit von 0.087890625° zulässt.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. Stepper Motor Modi</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6669%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Typ</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Enum Attribut</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Schritte pro 360°</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Energie</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kraft</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Half Stepping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">StepperMotorMode.HALF_STEP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ca. 1.5x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110% bis 120%</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single Stepping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">StepperMotorMode.SINGLE_STEP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2048</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100%</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dual Stepping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">StepperMotorMode.DOUBLE_STEP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2048</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">130% bis 140%</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Auf YouTube findet ihr ein sehr informatives Video von Gaven MacDonald über die Funktionsweise eines Stepper Motors. <a href="https://www.youtube.com/watch?v=Dc16mKFA7Fo" class="bare">https://www.youtube.com/watch?v=Dc16mKFA7Fo</a></p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.bastelgarage.ch/stepper-motor-schrittmotor-5v-1-64-28byj-48"><img src="./assets/images/stepper_motor_and_driver.png" alt="stepper motor and driver" width="75% RaspiCam Wiring"></a>
</div>
<div class="title">Figure 34. Stepper Motor Verkabelung</div>
</div>
<div class="sect3">
<h4 id="_verkabelung_9">5.9.1. Verkabelung</h4>
<div class="paragraph">
<p>Für die Verkabelung wird folgende Hardware benötigt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1x Steper Motor</p>
</li>
<li>
<p>1x ULN2003APG Stepper Treiber</p>
</li>
<li>
<p>8x Kabel</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/fritzing/stepper_motor.png" alt="stepper motor" width="75% RaspiCam Wiring">
</div>
<div class="title">Figure 35. Stepper Motor Verkabelung</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_9">5.9.2. API</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. Stepper Motor - Konstruktoren</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Konstruktor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">StepperMotorComponent(com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut1, com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut2, com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut3, com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut4)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor which uses the default value of 2 milliseconds for the step delay and the default stepper motor mode 'SINGLE_STEP'.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">StepperMotorComponent(com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut1, com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut2, com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut3, com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut4, int stepDelay)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor which uses the default value 'SINGLE_STEP' for the stepper motor mode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">StepperMotorComponent(com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut1, com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut2, com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut3, com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut4, int stepDelay, StepperMotorMode mode)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor which allows to specify all the different Parameters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">StepperMotorComponent(com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut1, com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut2, com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut3, com.pi4j.io.gpio.GpioPinDigitalOutput digitalOut4, StepperMotorMode mode)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor which uses the default value of 2 milliseconds for the step delay.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. Stepper Motor - Funktionen</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rückgabetyp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Funktion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">StepperMotorMode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">getMode()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Getter of the stepper motor mode value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">getStepDelay()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Getter of the step delay value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setMode(StepperMotorMode mode)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Setter of the stepper motor mode value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setStepDelay(int stepDelay)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Setter of the step delay value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stepBackwards(int steps)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Step the stepper motor backwards using the currently set mode for a specific amount of steps.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stepForwards(int steps)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Step the stepper motor forwards using the currently set mode for a specific amount of steps.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stop()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This methods stops the motor and clears the magnetic field.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_anwendungsbeispiel_9">5.9.3. Anwendungsbeispiel</h4>
<div class="paragraph">
<p>Das unten abgebildete Beispiel zeigt die Verwendung der verschiedenen Stepper Motor Modi. Das Beispiel verwendet den Konstruktor mit den meisten Default Values. Die Step Delay beträgt also 2 Millisekunden und der Modus wird initial auf <code>StepperMotorMode.SINGLE_STEP</code> gesetzt. Nach der Initialisierung wird der Motor in den verschiedenen Modi vorwärts und zurück gedreht. Vor jedem Wechsel in einen anderen Modus wird fünf Sekunden gewartet.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @Override public void execute() throws Exception {
        GpioProvider provider = new RaspiGpioProvider(RaspiPinNumberingScheme.BROADCOM_PIN_NUMBERING);
        GpioFactory.setDefaultProvider(provider);
        final GpioController gpio = GpioFactory.getInstance();

        Console console = new Console();
        console.promptForExit();

        GpioPinDigitalOutput out1 = gpio.provisionDigitalOutputPin(RaspiBcmPin.GPIO_17);
        GpioPinDigitalOutput out2 = gpio.provisionDigitalOutputPin(RaspiBcmPin.GPIO_18);
        GpioPinDigitalOutput out3 = gpio.provisionDigitalOutputPin(RaspiBcmPin.GPIO_27);
        GpioPinDigitalOutput out4 = gpio.provisionDigitalOutputPin(RaspiBcmPin.GPIO_22);
        StepperMotorComponent stepperMotor = new StepperMotorComponent(out1, out2, out3, out4);

        console.println("Make 4096 steps forwards with half step mode");
        stepperMotor.setMode(StepperMotorMode.HALF_STEP);
        stepperMotor.stepForwards(4096);
        stepperMotor.stop();
        Thread.sleep(500);
        console.println("Make 4096 steps backwards with half step mode");
        stepperMotor.stepBackwards(4096);
        stepperMotor.stop();

        Thread.sleep(5000);

        console.println("Make 2048 steps forwards with single step mode");
        stepperMotor.setMode(StepperMotorMode.SINGLE_STEP);
        stepperMotor.stepForwards(2048);
        stepperMotor.stop();
        Thread.sleep(500);
        console.println("Make 2048 steps backwards with single step mode");
        stepperMotor.stepBackwards(2048);
        stepperMotor.stop();

        Thread.sleep(5000);

        console.println("Make 2048 steps forwards with double step mode");
        stepperMotor.setMode(StepperMotorMode.DOUBLE_STEP);
        stepperMotor.stepForwards(2048);
        stepperMotor.stop();
        Thread.sleep(500);
        console.println("Make 2048 steps backwards with double step mode");
        stepperMotor.stepBackwards(2048);
        stepperMotor.stop();

        gpio.shutdown();
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_servo_motor">5.10. Servo Motor</h3>
<div class="paragraph">
<p>Mittels Servo Motoren können spezifische Winkelpositionen eingestellt und gehalten werden. Positionen können dabei zügig gewechselt werden. Die meisten Servo Motoren erlauben Winkel zwischen 0 und 180 Grad. Der einzustellende Winkel wird dabei über PWM gesteuert. Genauer gesagt über dessen Pulslänge.</p>
</div>
<div class="sect3">
<h4 id="_verkabelung_10">5.10.1. Verkabelung</h4>
<div class="paragraph">
<p>Für die Verkabelung wird folgende Hardware benötigt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1x Tower Pro Micro Servo 9g SG90</p>
</li>
<li>
<p>3x Kabel</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/fritzing/servo_motor.png" alt="servo motor" width="75% Servo Motor Fritzing">
</div>
<div class="title">Figure 36. Servo Motor Verkabelung</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_10">5.10.2. API</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. Servo Motor - Konstruktoren</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Konstruktor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ServoMotorComponent(com.pi4j.io.gpio.GpioPinPwmOutput pin)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor with default value for pulseMin = 500, pulseMax = 2400 and maxDegrees = 180. This constructor can be used for most micro and mini servo motors.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ServoMotorComponent(com.pi4j.io.gpio.GpioPinPwmOutput pin, int pulseMin, int pulseMax)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor with default value for maxDegrees of 180 degrees.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ServoMotorComponent(com.pi4j.io.gpio.GpioPinPwmOutput pin, int pulseMin, int pulseMax, int maxDegrees)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor with all possible values.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. Servo Motor - Funktionen</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rückgabetyp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Funktion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setCenter()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the servo to its center position.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setMax()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the servo to its maximal position.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setMin()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the servo to its minimal position.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setPosition(int pulse)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the servo position to a specific pulse high time in microseconds.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setPositionDegrees(int degree)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the servo position to a desired angle in degrees.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_anwendungsbeispiel_10">5.10.3. Anwendungsbeispiel</h4>
<div class="paragraph">
<p>Das unten abgebildete Beispiel zeigt die Verwendung unserer ServoMotorComponent. Es benutzt den Konstruktor mit den meisten Standardwerten. Dieser eignet sich für die meisten 180° Mini und Micro Servos.</p>
</div>
<div class="paragraph">
<p>In einem while-Loop wird der Motor zuerst auf die kleinstmögliche Position gesetzt. Anschliessend setzen wir die Position des Motors auf dessen Mitte und im Anschluss auf die maximale Position. Zwischen den einzelnen Positionswechsel macht das Programm jeweils eine Sekunde Pause. Nun wird der Motor auf seine Ausgangsposition zurückgesetzt und Grad für Grad bis zum Maximum von 180° gedreht.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @Override public void execute() throws Exception {
        GpioProvider provider = new RaspiGpioProvider(RaspiPinNumberingScheme.BROADCOM_PIN_NUMBERING);
        GpioFactory.setDefaultProvider(provider);
        final GpioController gpio = GpioFactory.getInstance();

        Console console = new Console();
        console.promptForExit();

        GpioPinPwmOutput pwm = gpio.provisionPwmOutputPin(RaspiBcmPin.GPIO_18);
        ServoMotorComponent servo = new ServoMotorComponent(pwm);

        while (console.isRunning()) {
            servo.setMin();
            Thread.sleep(1000);
            servo.setCenter();
            Thread.sleep(1000);
            servo.setMax();
            Thread.sleep(1000);

            for (int i = 0; i &lt;= 180; i++) {
                servo.setPositionDegrees(i);
                Thread.sleep(100);
            }
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_grove_serial_camera">5.11. Grove Serial Camera</h3>
<div class="paragraph">
<p>Die Grove Serial Camera besteht aus einem Kamera Modul und einem Control Board, welches die Kommunikation zwischen der Kamera und dem Raspberry Pi über den Serial Bus ermöglicht. Die Kamera benötigt eine Spannung von 5 Volt, weshalb sie leider nicht mit unserem Grove Hat kompatibel ist. Dieser liefert nur 3.3 Volt an die Grove Adapter. Um die Kamera dennoch nutzen zu können, muss sie via Jumper Kabel an den Serial Port des Raspberry Pi angeschlossen werden. Weitere Informationen zur Verkabelung können dem Tutorial entnommen werden.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://wiki.seeedstudio.com/Grove-Serial_Camera_Kit/"><img src="./assets/images/Grove_Serial_Camera.jpg" alt="Grove Serial Camera" width="75% Grove Serial Camera"></a>
</div>
<div class="title">Figure 37. Grove Serial Camera</div>
</div>
<div class="sect3">
<h4 id="_verkabelung_11">5.11.1. Verkabelung</h4>
<div class="paragraph">
<p>Für die Verkabelung wird folgende Hardware benötigt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1x Grove Serial Camera mit Grove Adapter Kabel</p>
</li>
<li>
<p>4x Kabel</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/fritzing/grove_serial_cam.png" alt="grove serial cam" width="75% Grove Serial Camera Fritzing">
</div>
<div class="title">Figure 38. Serial Camera Verkabelung</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_11">5.11.2. API</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 22. Serial Camera - Konstruktoren</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Konstruktor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SerialCameraComponent(int packageSize)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor of the SerialCameraComponent. Configures the default serial port of the Raspberry Pi.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SerialCameraComponent()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor of the SerialCameraComponent with a default package size of 512 bytes. Configures the default serial port of the Raspberry Pi.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. Serial Camera - Funktionen</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rückgabetyp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Funktion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">byte[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">getImageAsJpgBytes()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This method request a jpg image of the camera and returns it as a byte array.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">saveImageAsJpg(java.lang.String fileName)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Requests a jpg image from the camera and streams it to a file. The file name will be extended with a time stamp and the .jpg file extension.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.lang.String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">saveImageAsJpg(java.lang.String relativePath, java.lang.String fileName)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Requests a jpg image from the camera and streams it to a file. The file name will be extended with a time stamp and the .jpg file extension.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_anwendungsbeispiel_11">5.11.3. Anwendungsbeispiel</h4>
<div class="paragraph">
<p>Das unten abgebildete Code Beispiel zeigt, wie mit der Hilfe unserer SerialCameraComponent ein JPEG Foto geschossen und unter einem bestimmten Pfad abgespeichert werden kann.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @Override public void execute() throws Exception {
        GpioFactory.setDefaultProvider(new RaspiGpioProvider(RaspiPinNumberingScheme.BROADCOM_PIN_NUMBERING));
        Console console = new Console();
        console.promptForExit();

        console.println("taking a picture. please smile :)");
        SerialCameraComponent cam = new SerialCameraComponent(1024);
        String fileName = cam.saveImageAsJpg("pictures", "GroveCamPic_");
        console.println("picture was taken and saved in file " + fileName);
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_raspberry_pi_camera">5.12. Raspberry Pi Camera</h3>
<div class="paragraph">
<p>Die Raspberry Pi Camera ist die Camera Komponente, welche standardmässig vom Pi unterstützt wird. Es ist eine kleine 8MP Kamera, die über ein Flachbandkabel direkt an den Pi angeschlossen werden kann. Man kann 3280 x 2464 Pixel für Bilder verwenden und 1080p mit 30fps/ 720p mit 60fps/ 640x480p mit 90fps für Videos.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://projects.raspberrypi.org/en/projects/getting-started-with-picamera"><img src="./assets/images/RaspberryPi_Camera.jpg" alt="RaspberryPi Camera" width="70% RaspiCam"></a>
</div>
<div class="title">Figure 39. Raspberry Pi Camera</div>
</div>
<div class="paragraph">
<p>Für die Verwendung muss sie aber zunächst im OS aktiviert werden. Unter den Interfacing Options, von raspi-config können Sie es problemlos aktivieren.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/RaspberryPi_Camera_Activation.jpg" alt="RaspberryPi Camera Activation" width="60% activate RaspiCam">
</div>
<div class="title">Figure 40. Raspberry Pi Camera aktivieren</div>
</div>
<div class="paragraph">
<p>Raspbian OS enthält auch Applikationen, welche sie nutzen können, um die Camera in der Console zu testen.</p>
</div>
<div class="paragraph">
<p>Starten Sie ihr Terminal und geben sie folgenden Befehl ein:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">raspistill -o /home/pi/Pictures/image.jpg</code></pre>
</div>
</div>
<div class="paragraph">
<p>Jetzt sollten Sie ein Bild im Standardverzeichnis für Bilder finden können.</p>
</div>
<div class="paragraph">
<p>Für mehr Informationen über die Befehle können Sie den Zusatzinformationsteil für die Raspberry Pi Camera anschauen &#8594;
<a href="#_terminal_befehle">Terminal Befehle</a></p>
</div>
<div class="sect3">
<h4 id="_verkabelung_12">5.12.1. Verkabelung</h4>
<div class="paragraph">
<p>Für die Verkabelung wird folgende Hardware benötigt:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1x Raspberry Pi Camera mit Flachbandkabel</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/fritzing/raspiCam.png" alt="raspiCam" width="60% RaspiCam Wiring">
</div>
<div class="title">Figure 41. Raspberry Pi Camera Verkabelung</div>
</div>
</div>
<div class="sect3">
<h4 id="_api_12">5.12.2. API</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 24. Raspberry Pi Camera - Konstruktoren</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Konstruktor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RaspberryPiCameraComponent​(uk.co.caprica.picam.CameraConfiguration raspiStillConfiguration)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor for only using the picture functionality.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RaspberryPiCameraComponent​(fhnwgpio.components.helper.RaspiVidConfiguration raspiVidConfiguration)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor for only using the video functionality.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RaspberryPiCameraComponent​(uk.co.caprica.picam.CameraConfiguration raspiStillConfiguration, fhnwgpio.components.helper.RaspiVidConfiguration raspiVidConfiguration)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor for using the picture and video functionality.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 25. Raspberry Pi Camera - Funktionen</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Rückgabetyp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Funktion</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">takeStill()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Takes picture and saves it to the default Pictures folder.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">takeStill​(String outputPath)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Takes picture and saves it to the specified outputPath.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">takeStill​(String outputPath, int delay)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Takes a picture using the picam library and saves it to the specified output after a delay.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">takeVid​(java.lang.String outputPath)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Takes a video with the configuration and saves it to the output path.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CameraConfiguration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">createCameraConfiguration()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The picam library has a private constructor and therefore needs this method.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_anwendungsbeispiel_12">5.12.3. Anwendungsbeispiel</h4>
<div class="paragraph">
<p>In diesem Code Beispiel wird die Raspberry Pi Camera mit der <code>RaspberryPiCameraComponent</code> verwendet, um zwei Bilder und ein Video aufzunehmen in den Ordner <code>/home/pi/Pictures/</code>. <br>
<strong>Vorkenntnisse: Intermediate</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">        Console console = new Console();
        console.promptForExit();

        //configuration for pictures using raspistill with builder object
        CameraConfiguration stillConfig = RaspberryPiCameraComponent.createCameraConfiguration()
                .width(1920)
                .height(1080)
                .encoding(Encoding.JPEG)
                .quality(85)
                .rotation(180);


        //configuration for videos using raspivid with builder object
        RaspiVidConfiguration vidConfig = new RaspiVidConfiguration()
                .verticalflip()
                .previewOff()
                .time(15000);

        //initialise the camera component using the two configurations
        RaspberryPiCameraComponent raspberryPiCamera = new RaspberryPiCameraComponent(stillConfig, vidConfig);

        console.println("Config done");

        raspberryPiCamera.takeStill("/home/pi/Pictures/picam1.jpg", 3000);
        raspberryPiCamera.takeStill("/home/pi/Pictures/picam2.jpg");

        //take video
        raspberryPiCamera.takeVid("/home/pi/Pictures/video.h264");

        System.out.println("End of example");</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_beispielprojekt">6. Beispielprojekt</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dieses Beispielprojekt soll zeigen, wie die Geräte in einem kleinen Projekt zusammenspielen können.</p>
</div>
<div class="paragraph">
<p>Das Projekt ist eine Art Photo Booth, also eine Fotobox in der die folgenden Geräte zusammenarbeiten müssen, um ein gutes Foto von einer Person zu machen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Button</p>
</li>
<li>
<p>Buzzer</p>
</li>
<li>
<p>LCD Display</p>
</li>
<li>
<p>LED (LED Streifen)</p>
</li>
<li>
<p>Raspberry Pi (Grove Camera)</p>
</li>
<li>
<p>Motor als Countdown</p>
</li>
<li>
<p>ev Ranger für Distanz</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_komponenten_klassen_als_library_hinzufügen">6.1. Komponenten Klassen als Library hinzufügen</h3>
<div class="paragraph">
<p>Um die Komponenten Klassen in einem neuen Projekt zu verwenden, muss man die Jar-Datei in dem neuen Projekt als Bibliothek hinzufügen.</p>
</div>
<div class="paragraph">
<p>Unter den Releases der Github-Repository finden Sie die Jar-Datei: <a href="https://github.com/FHNW-IP5-IP6/GPIOSimulator/releases/" class="bare">https://github.com/FHNW-IP5-IP6/GPIOSimulator/releases/</a></p>
</div>
<div class="paragraph">
<p>Diese Jar-Datei muss in einen geeigneten Ordner im neuen Projekt hinzugefügt werden wie zum Beispiel <code>/build/libs</code></p>
</div>
<div class="paragraph">
<p>In der Datei <code>build.gradle</code> muss man dann nur noch die Library angeben, dann sind die Komponenten Klassen wie in den Beispielen in Kapitel 5 nutzbar:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>repositories {
    mavenCentral()
    flatDir {
        dirs 'build/libs'
    }
}

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.12'
    implementation name: 'GPIOSimulator-0.1'
}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_zusatzinformationen">7. Zusatzinformationen</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_led_2">7.1. LED</h3>
<div class="paragraph">
<p>Die LED ist wohl für die meisten GPIO Programmiererinnen und Programmierer die erste Komponente, welche an den Controller angeschlossen wird. Die blinkende LED ist quasi das "Hello World" der Hardware Programmierung. Auch wir haben die LED als erste Komponente an unseren Raspberry Pi angeschlossen.</p>
</div>
<div class="paragraph">
<p>Die von uns implementierte Component-Klasse unterstützt die Statusänderung von LEDs, welche entweder direkt an die GPIO Pins der Raspberry Pi angeschlossen wurden, sowie auch jene, welche über den Grove Base Hat via dessen digitalen Adapter verbunden wurden. Wird dem Konstruktor ein ` GpioPinPwmOutput` Pin übergeben, lässt sich zusätzlich die Helligkeit der LED steuern.</p>
</div>
<div class="sect3">
<h4 id="_status_modifizieren">7.1.1. Status modifizieren</h4>
<div class="paragraph">
<p>Alle Konstruktoren erlauben das Setzen des Status einer LED. Mit den Funktionen <code>turnLedOn()</code> sowie <code>turnLedOff()</code> kann kontrolliert werden, ob die LED leuchtet oder nicht.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void turnLedOn() {
        if (dimmable) {
            setBrightness(100);
        } else {
            pin.high();
        }

        ComponentLogger.logInfo("LedComponent: LED turned on");
    }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void turnLedOff() {
        if (dimmable) {
            setBrightness(0);
        } else {
            pin.high();
        }

        ComponentLogger.logInfo("LedComponent: LED turned off");
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_helligkeit_via_pwm_setzen">7.1.2. Helligkeit via PWM setzen</h4>
<div class="paragraph">
<p>Die Helligkeit der LED kann nur dann eingestellt werden, wenn der Pin, an welchen die LED angeschossen ist, ein PWM Signal sendet. Die Präzision des PWM Signals ist bei LEDs zweitrangig, weshalb auch Software PWM Signale erlaubt sind.</p>
</div>
<div class="paragraph">
<p>Im entsprechenden Konstruktor setzen wir die gewünschte PWM Frequenz auf 50 Hertz.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public LedComponent(GpioPinPwmOutput pwmPin) {
        this.pwmPin = pwmPin;
        this.dimmable = true;

        Gpio.pwmSetMode(Gpio.PWM_MODE_MS);
        Gpio.pwmSetClock(192);
        Gpio.pwmSetRange(2000);
        pwmPin.setPwmRange(100);
        ComponentLogger.logInfo("LedComponent: Created component for pwm pin " + pwmPin.getPin().getAddress());
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wir der oben gezeigte Konstruktor genutzt, kann die LED über PWM gedimmt werden. Dazu steht dem Anwender die Funktion <code>setBrightness()</code> zur Verfügung. Die gewünschte Helligkeit muss als Prozentzahl übermittelt werden. Erlaubt sind nur Werte im Range 0 bis 100.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void setBrightness(int brightness) throws IllegalArgumentException {
        if (!dimmable) {
            IllegalArgumentException exception = new IllegalArgumentException(
                    "LedComponent: Please provide a GpioPinPwmOutput Pin in the constructor if you want to dim your led");
            ComponentLogger.logError(exception.getMessage());
            throw exception;
        }

        if (brightness &lt; 0 || brightness &gt; 100) {
            IllegalArgumentException exception = new IllegalArgumentException(
                    "LedComponent: Please enter a brightness between 0 and 100");
            ComponentLogger.logError(exception.getMessage());
            throw exception;
        }

        pwmPin.setPwm(brightness);
        ComponentLogger.log(Level.INFO, "LedComponent: LED set to " + brightness + "% brightness");
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_button_2">7.2. Button</h3>
<div class="paragraph">
<p>Buttons gehören zu den Input Devices. Ein Button kann zwei Zustände annehmen. Entweder ist er gedrückt oder nicht gedrückt. Je nach Button Typ leitet er im gedrückten oder offenen Zustand Strom. Diesen Strom können wir an einem digitalen Input Pin des Raspberry Pi messen.</p>
</div>
<div class="paragraph">
<p>Um sogenannte Floating Pins zu vermeiden, müssen Buttons mit einem Pulldown-Wiederstand an einen Input angeschlossen werden. Grove Buttons und Grove Touch Sensoren haben einen solchen Pulldown-Wiederstand bereits integriert.</p>
</div>
<div class="sect3">
<h4 id="_pulldown_wiederstand_im_schaltbild">7.2.1. Pulldown-Wiederstand im Schaltbild</h4>
<div class="paragraph">
<p>Damit wir einen Button als Input Device verwenden können, müssen wir einen Pulldown-Wiederstand in unserer elektrischen Schaltung realisieren. Ein solcher Wiederstand garantiert uns immer einen sicheren Wert, welcher an unserem digitalen GPIO Input Pin anliegt.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.elektronik-kompendium.de/sites/raspberry-pi/2006051.htm"><img src="./assets/images/pulldown.gif" alt="pulldown" width="75% Pulldown Ressistor"></a>
</div>
<div class="title">Figure 42. Schaltbild Pulldown-Wiederstand</div>
</div>
<div class="paragraph">
<p>Wie man im Schaltbild erkennen kann, liest der GPIO Pin bei offenem Schalter eine Spannung von 0V des Ground Pins. Bei geschlossenem Schalter liegt die volle Spannung von 3.3V am GPIO Pin an. Der Input Pin besitzt also immer einen fixen Zustand. Entweder ist er High oder Low.</p>
</div>
<div class="paragraph">
<p>Würden wir +VCC direkt mit dem GPIO Pin verbinden und einen Schalter dazwischen positionieren, so würde bei geschlossenem Schalter 3.3V Spannung am GPIO Input Pin anliegen. Der Pin wäre High. Ist der Schalter jedoch offen, liegt kein klar definierter Wert am Pin an. Der Wert kann zwischen 0V und 3.3V variieren. Ein Pin in diesem Zustand wird als "Floating" bezeichnet.</p>
</div>
<div class="paragraph">
<p>In unserem Beispiel verwenden wir einen Pulldown-Wiederstand von 10k Ohm. Zusätzlich schützen wir den Input Pin mit einem 1k Ohm Wiederstand, welcher in der oberen Grafik fehlt. Dieser 1k Ohm Wiederstand soll den Pin vor Programmierfehler schützen. Würde der GPIO Pin versehentlich als Output Pin im Programmcode deklariert werden, könnte dieser ohne den schützenden Wiederstand beschädigt werden.</p>
</div>
</div>
<div class="sect3">
<h4 id="_pulldown_wiederstand_des_raspberry_pi">7.2.2. Pulldown-Wiederstand des Raspberry Pi</h4>
<div class="paragraph">
<p>Der Raspberry Pi besitzt einen internen Pulldown-Wiederstand, welcher via Software aktiviert werden kann. Dieser funktioniert prinzipiell gleich wie der von uns beschriebene Pulldown-Wiederstand im Schaltbild. Wir raten allerdings von der Verwendung des internen Pulldown-Wiederstandes ab. Diesen zu aktivieren kann schnell vergessen gehen. Im schlimmsten Fall führt dies dann zu einer Beschädigung des entsprechenden GPIO Pins.</p>
</div>
<div class="paragraph">
<p>Mittels Pi4J kann ein digitaler Input Pin mit aktivem Pulldown-Wiederstand mittels folgender Code Zeile erzeugt werden:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">GpioPinDigitalInput pin = gpio.provisionDigitalInputPin(RaspiBcmPin.GPIO_03, PinPullResistance.PULL_DOWN);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_zustand_lesen">7.2.3. Zustand lesen</h4>
<div class="paragraph">
<p>Das Lesen des Inputs ist sehr simpel. Pi4J stellt uns Hierfür die Funktionen <code>isHigh()</code> sowie <code>isLow()</code> direkt auf dem <code>GpioPinDigitalInput</code> zur Verfügung. Mittels Inline If invertieren wir den Rückgabewert, sofern es sich um einen Button handelt, welcher im geschlossenen Zustand nicht gedrückt ist.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public boolean isPressed() {
        return reverse ? !pin.isHigh() : pin.isHigh();
    }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>    public boolean isReleased() {
        return reverse ? !pin.isLow() : pin.isLow();
    }</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_buzzer_2">7.3. Buzzer</h3>
<div class="paragraph">
<p>Damit ein Buzzer einen Ton abspielt, muss ein bestimmtes PWM Signal anliegen. Das Signal versetzt eine Platte im Inneren des Buzzers in Schwingungen. Die daraus entstehenden Schallwellen generieren den Ton, welchen wir hören können.</p>
</div>
<div class="paragraph">
<p>Für das Abspielen von Tönen ist eine Exakte Frequenz sehr wichtig. Aus diesem Grund unterstützt unsere Component Klasse nur Hardware PWM Pins des Raspberry Pi.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.islproducts.com/design-notes/piezo-buzzers-vs-magnetic-buzzers/"><img src="./assets/images/buzzer_construction.jpg" alt="buzzer construction" width="75% Buzzer Construction"></a>
</div>
<div class="title">Figure 43. Buzzer Aufbau</div>
</div>
<div class="sect3">
<h4 id="_clock_divider_berechnen">7.3.1. Clock Divider berechnen</h4>
<div class="paragraph">
<p>Damit ein bestimmter Ton abgespielt werden kann, muss sichergestellt werden, dass der PWM Pin, an welchem der Buzzer angeschlossen ist, ein Signal in der richtigen Frequenz liefert. Um dies zu realisieren, müssen wir herausfinden, um welchen Dividenden wir die Basisfrequenz von 19.2MHz des Raspberry Pi reduzieren müssen. Dazu teilen wir die Basisfrequenz durch die Tonfrequenz und den <code>dutyCycle</code>. Der Duty Cycle bestimmt, wie lange das Signal High geschaltet ist. Wir verwenden den Wert 512, was einer High Time von exakt 50% entspricht.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    private int calculateClock(int frequency) {
        double divider = (double) piFrequency / frequency;
        return (int) divider / dutyCycle;
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ton_abspielen">7.3.2. Ton abspielen</h4>
<div class="paragraph">
<p>Ein Ton besteht aus einer Frequenz, welche über eine bestimmte Dauer wiedergegeben wird. Damit wir einen Ton abspielen können, müssen wir den errechneten Clock Divider via WiringPi setzen und auf dem PWM Pin schreiben. Danach wird das Programm pausiert, bis die gewünschte Tondauer erreicht wurde.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void playTone(int frequency, int duration) throws InterruptedException {
        ComponentLogger
                .logInfo("BuzzerComponent: Play tone with " + frequency + "Hz for " + duration + " milliseconds");

        if (frequency != 0) {
            int clock = calculateClock(frequency);
            Gpio.pwmSetClock(clock);
            Gpio.pwmWrite(pin.getAddress(), clock);
            Thread.sleep(duration);
        } else {
            stop(duration);
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lcd_i2c_2">7.4. LCD I2C</h3>
<div class="paragraph">
<p>Das LCD Modul besteht aus dem LCD1602 I2C und dem PCF8574 I2C extender Mikrochip auf dem Rücken des LCDs. Der I2C Extender vereinfacht die Verkabelung und das Senden von Daten an das LCD-Display, da man ohne I2C Extender 8 GPIO Pins belegen müsste.</p>
</div>
<div class="sect3">
<h4 id="_befehle_für_den_lcd1602">7.4.1. Befehle für den LCD1602</h4>
<div class="paragraph">
<p>Das LCD1602 besitzt den folgenden Befehlssatz:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    private final byte LCD_CLEARDISPLAY = (byte) 0x01;
    private final byte LCD_RETURNHOME = (byte) 0x02;
    private final byte LCD_ENTRYMODESET = (byte) 0x04;
    private final byte LCD_DISPLAYCONTROL = (byte) 0x08;
    private final byte LCD_CURSORSHIFT = (byte) 0x10;
    private final byte LCD_FUNCTIONSET = (byte) 0x20;
    private final byte LCD_SETCGRAMADDR = (byte) 0x40;
    private final byte LCD_SETDDRAMADDR = (byte) 0x80;

    // flags for display entry mode
    private final byte LCD_ENTRYRIGHT = (byte) 0x00;
    private final byte LCD_ENTRYLEFT = (byte) 0x02;
    private final byte LCD_ENTRYSHIFTINCREMENT = (byte) 0x01;
    private final byte LCD_ENTRYSHIFTDECREMENT = (byte) 0x00;

    // flags for display on/off control
    private final byte LCD_DISPLAYON = (byte) 0x04;
    private final byte LCD_DISPLAYOFF = (byte) 0x00;
    private final byte LCD_CURSORON = (byte) 0x02;
    private final byte LCD_CURSOROFF = (byte) 0x00;
    private final byte LCD_BLINKON = (byte) 0x01;
    private final byte LCD_BLINKOFF = (byte) 0x00;

    // flags for display/cursor shift
    private final byte LCD_DISPLAYMOVE = (byte) 0x08;
    private final byte LCD_CURSORMOVE = (byte) 0x00;
    private final byte LCD_MOVERIGHT = (byte) 0x04;
    private final byte LCD_MOVELEFT = (byte) 0x00;

    // flags for function set
    private final byte LCD_8BITMODE = (byte) 0x10;
    private final byte LCD_4BITMODE = (byte) 0x00;
    private final byte LCD_2LINE = (byte) 0x08;
    private final byte LCD_1LINE = (byte) 0x00;
    private final byte LCD_5x10DOTS = (byte) 0x04;
    private final byte LCD_5x8DOTS = (byte) 0x00;

    // flags for backlight control
    private final byte LCD_BACKLIGHT = (byte) 0x08;
    private final byte LCD_NOBACKLIGHT = (byte) 0x00;

    private final byte En = (byte) 0b00000100; // Enable bit
    private final byte Rw = (byte) 0b00000010; // Read/Write bit
    private final byte Rs = (byte) 0b00000001; // Register select bit</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_initialisierung">7.4.2. Initialisierung</h4>
<div class="paragraph">
<p>Das LCD Display wird im nach dem Protokoll folgendermassen initialisiert:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.waveshare.com/datasheet/LCD_en_PDF/LCD1602.pdf"><img src="./assets/images/LCD_Init.PNG" alt="LCD Init" width="75% LCD Init"></a>
</div>
<div class="title">Figure 44. LCD1602 Init</div>
</div>
<div class="paragraph">
<p>Die Initialisierung wurde in java folgendermassen realisiert:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void init() {
        try {
            writeCommand((byte) 0x03);
            writeCommand((byte) 0x03);
            writeCommand((byte) 0x03);
            writeCommand((byte) 0x02);

            writeCommand((byte) (LCD_FUNCTIONSET | LCD_2LINE | LCD_5x8DOTS | LCD_4BITMODE));
            writeCommand((byte) (LCD_DISPLAYCONTROL | LCD_DISPLAYON));
            writeCommand(LCD_CLEARDISPLAY);
            writeCommand((byte) (LCD_ENTRYMODESET | LCD_ENTRYLEFT));
            Thread.sleep(0, 200000);
            ComponentLogger.logInfo("I2CLCDComponent: initialised");
        } catch (Exception ex) {
            ComponentLogger.logError("I2CLCDComponent: Error while trying to initialise " + ex.getMessage());
        }
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_text_auf_dem_display_anzeigen">7.4.3. Text auf dem Display anzeigen</h4>
<div class="paragraph">
<p>Sobald das LCD-Display initialisiert wurde, kann es jedes Zeichen auf der Zeichentabelle anzeigen. Das Display hat zwei Zeilen mit Platz für je 16 Zeichen, welche einzeln dem LCD zugeschickt werden müssen. Die einzelnen Zeichen werden in 8 Bit dargestellt, da aber das Gerät im 4-Bit Modus arbeitet, werden zuerst die 4-Bit auf der linken Seite der Zeichentabelle gesendet und danach die 4-Bit die oben zusehen sind in der Zeichentabelle.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.waveshare.com/datasheet/LCD_en_PDF/LCD1602.pdf"><img src="./assets/images/LCD_Characters.PNG" alt="LCD Characters" width="75% LCD Character Table"></a>
</div>
<div class="title">Figure 45. LCD1602 Zeichentabelle</div>
</div>
<div class="paragraph">
<p>Wenn dem <code>I2CLCDComponent</code> ein ganzer String übergeben wird, dann werden alle Zeichen des Strings einzeln dem LCD geschickt und jeweils in zwei Nibbles (4-Bits) eingeteilt und gesendet.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void displayText(String text, int line, int pos, boolean jumpToNextLine) {
        ComponentLogger.logInfo("I2CLCDComponent: displaying text: '" + text + "' on line " + line);

        if (text.length() &gt; 32 - pos) {
            text = text.substring(0, 31 - pos);
            ComponentLogger.logInfo("I2CLCDComponent: text length cut to 31 characters");
        }

        String firstLine = text, secondLine = text;
        byte posNew;

        //lcd only has 2 lines, so I assume the first one if the second one wasn't selected explicitly
        if (line != 2) {
            posNew = (byte) pos;
            boolean textLargerThanLine = text.length() &gt; COLUMNS - pos;
            if (textLargerThanLine) {
                firstLine = text.substring(0, 16 - pos);
                secondLine = text.substring(COLUMNS - pos);
            }
            displayLine(firstLine, posNew);
            if (jumpToNextLine &amp;&amp; textLargerThanLine) displayLine(secondLine, posNew + 0x40);
        } else {
            posNew = (byte) (0x40 + pos);
            displayLine(secondLine, posNew);
        }
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_spezielle_anzeigefunktionen">7.4.4. Spezielle Anzeigefunktionen</h4>
<div class="paragraph">
<p>Das <code>I2CLCDComponent</code> hat zusätzlich zur normalen Anzeige noch 2 weitere Funktionen für besondere Anzeigemöglichkeiten:</p>
</div>
<div class="paragraph">
<p><strong>Scroll Text</strong><br>
Ein Scroll Text ist ein Text, welcher von der Länge her die 32 Zeichen auf dem LCD übersteigt, deshalb werden zuerst einfach die ersten 32 Zeichen auf dem Display angezeigt. Mit einer Verzögerung, die man selber angeben kann, verschwinden dann langsam die ersten Zeichen und die darauffolgenden Zeichen werden angezeigt, was dann aussieht wie ein seitliches Scrollen.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void displayScrollText(String text, int line, int delay, boolean jumpToNextLine, boolean startAgain) throws InterruptedException {
        ComponentLogger.logInfo("I2CLCDComponent: displaying scroll text: '" + text + "' on line " + line + "with a delay of " + delay + " milliseconds");

        String paddedtext = getEmptyLine() + text;

        for (int i = 0; i &lt; paddedtext.length(); i++) {
            displayText(paddedtext.substring(i), line, 0, jumpToNextLine);
            Thread.sleep(delay);
            if (jumpToNextLine)
                clearText(false);
            else
                clearLine(line);

            if (i == paddedtext.length() - 1 &amp;&amp; startAgain)
                displayScrollText(text, line, delay, jumpToNextLine, startAgain);
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Bounce Text</strong><br>
Ein Bounce ist für kurze Texte gedacht, denen vielleicht mehr Aufmerksamkeit geschenkt wird mittels eines kleinen Effekts. Ein kurzer Text bewegt sich mit einer Verzögerung von der einen Seite zur anderen, als würde der Text von der einen Seite zur Anderen springen.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void displayBounceText(String text, int line, int delay, boolean startAgain) throws InterruptedException {
        ComponentLogger.logInfo("I2CLCDComponent: displaying bounce text: '" + text + "' on line " + line + "with a delay of " + delay + " milliseconds");

        // Bounce doesn't make sense for a large text
        if (text.length() &gt;= COLUMNS - 1) {
            IllegalArgumentException ex = new IllegalArgumentException("text has to be smaller than 15 characters");
            ComponentLogger.logError("I2CLCDComponent: " + ex.getMessage());
            throw ex;

        }

        //shifts the whole text to the right end
        for (int i = 0; i &lt; COLUMNS - text.length(); i++) {
            if (i + text.length() &lt;= COLUMNS) {
                displayText(text, line, i, false);
                Thread.sleep(delay);
                clearLine(line);
            }
        }
        //shifts the whole text to the left end
        for (int i = COLUMNS - text.length(); i &gt; 0; i--) {
            displayText(text, line, i, false);
            Thread.sleep(delay);
            clearLine(line);
        }
        if (startAgain) displayBounceText(text, line, delay, startAgain);
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_grove_rfid_reader_2">7.5. Grove RFID Reader</h3>
<div class="paragraph">
<p>Dieses Grove-125kHz RFID-Lesegerät ist ein Modul zum Lesen von em4100 RFID-Karteninformationen mit dem Ausgabeformaten Uart. Es hat eine Empfindlichkeit mit maximal 7cm Erfassungsabstand.</p>
</div>
<div class="paragraph">
<p>Der Grove RFID Reader erzeugt ein elektromagnetisches Wechselfeld , dem der RFID-Tag ausgesetzt wird. Die Hochfrequenzenergie versorgt den Chip im RFID-Tag mit Strom und der RFID-Tag kann dann die Daten auf dem Tag an den RFID Reader übertragen.</p>
</div>
<div class="sect3">
<h4 id="_kompatibilität_mit_rfid_tag">7.5.1. Kompatibilität mit RFID Tag</h4>
<div class="paragraph">
<p>Nicht jeder RFID-Tag ist mit dem Grove RFID Reader kompatibel. Die Daten auf dem Tag müssen dem Standart em4100 entsprechen, damit sie gelesen werden können. Em4100 legt fest, dass sich auf dem Tag 64 Bit Readonly Memory in folgendem Format befinden:
.em4100 Aufbau</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="http://www.priority1design.com.au/em4100_protocol.html"><img src="./assets/images/RFID_em4100.PNG" alt="RFID em4100" width="75% RFID em4100"></a>
</div>
</div>
<div class="paragraph">
<p>Ausserdem muss der Tag im selben Langwellen-Bereich von 125kHZ arbeiten können.</p>
</div>
</div>
<div class="sect3">
<h4 id="_rfid_tag_daten_ausgeben">7.5.2. RFID Tag Daten ausgeben</h4>
<div class="paragraph">
<p>Um die Daten aus dem Tag auszulesen kann man einfach den <code>SerialDataEventListener</code> von Pi4J dem <code>RFIDReaderComponent</code> übergeben. Wenn die 64 Bits an Daten beim Reader ankommen, dann werden sie davon angenommen.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">rfidReaderComponent.addListener(event -&gt; {
    // print out the data received to the console
    try {
        console.println("[HEX DATA]   " + event.getHexByteString());
        console.println("[ASCII DATA] " + event.getAsciiString());
    } catch (IOException e) {
        e.printStackTrace();
    }
});</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_grove_ultrasonic_ranger">7.6. Grove Ultrasonic Ranger</h3>
<div class="paragraph">
<p>Dieser Grove Ultrasonic Ranger ist ein berührungsloses Distanzmessmodul, das bei 40KHz arbeitet. Wenn wir ein Impuls-Triggersignal durch den Signal-Pin liefern, gibt der Grove Ultrasonic Ranger 8 Zyklen mit 40kHz Zykluspegel aus und erkennt das Echo.</p>
</div>
<div class="paragraph">
<p>Abstand = Echosignal hohe Zeit * Schallgeschwindigkeit (340M/S) / 2.</p>
</div>
<div class="paragraph">
<p>Das Triggersignal und das Echosignal des Grove Ultrasonic Ranger teilen sich denselben Pin.</p>
</div>
<div class="sect3">
<h4 id="_trigger_signal">7.6.1. Trigger Signal</h4>
<div class="paragraph">
<p>Das Trigger Signal welches eine Ultraschallwelle mit dem Ranger abfeuert muss zunächst den Pinmodus auf Output stellen, danach wird der Pin abwechselnd mit einem in der Spezifikation definierten Abstand auf LOW, HIGH und dann wieder LOW gesetzt.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">        ComponentLogger.logInfo("UltraSonicRangerComponent:  Triggered");
        Gpio.pinMode(pin, Gpio.OUTPUT);
        Gpio.digitalWrite(pin, false);
        Thread.sleep(0, 2000);
        Gpio.digitalWrite(pin, true);
        Thread.sleep(0, 10000);
        Gpio.digitalWrite(pin, false);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_echo_messen">7.6.2. Echo messen</h4>
<div class="paragraph">
<p>Um das Echo der abgefeuerten Schallwelle zu messen, muss zunächst der Pinmodus auf Input gewechselt werden. Dann muss zunächst abgewartet werden bis der Pin LOW (Emission der Schallwelle) ist und danach bis er HIGH (Rezeption der Schallwelle) ist.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">        int count = 0;
        int TIMEOUT = 1000000; //just a large number to avoid an endless loop when there is a device problem

        //wait for the pulse to start (ultra sonic wave sent)
        while (count &lt; TIMEOUT &amp;&amp; Gpio.digitalRead(pin) == 0)
            count++;

        if (count &gt;= TIMEOUT) return 0;
        long t1 = microTime();

        count = 0;
        //wait for the pulse to end (ultra sonic wave received)
        while (count &lt; TIMEOUT &amp;&amp; Gpio.digitalRead(pin) == 1)
            count++;
        if (count &gt;= TIMEOUT) return 0;
        long t2 = microTime();

        return t2 - t1; //return the time difference between emission and reception of the ultra sonic wave</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wenn die gemessene Zeit zwischen Emission und Rezeption durch 2 geteilt wird, dann erhält man nur die Zeit bis zum Erreichen des Objektes. Um die Distanz in einer anderen Einheit darzustellen, muss man es zusätzlich durch folgende Konstanten teilen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Für cm: <code>29</code></p>
</li>
<li>
<p>Für inches: <code>74</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_potentiometer_2">7.7. Potentiometer</h3>
<div class="paragraph">
<p>Das Grove Potentiometer wird über einen der analogen Ports an den Grove Base Hat angeschlossen. Der Grove Base Hat stellt die gelesenen oder zu schreibenden Werte über den I2C Bus dem Raspberry Pi zur Verfügung.</p>
</div>
<div class="sect3">
<h4 id="_konstruktor">7.7.1. Konstruktor</h4>
<div class="paragraph">
<p>Die <code>PotentiometerComponent</code> Klasse erweitert die von uns implementierte <code>I2CBase</code> Basisklasse. Im Konstruktor wird die I2C Adresse des analogen Potentiometers zusammen mit der zu verwendenden Bus Nummer an die Basisklasse weitergeleitet. Da der Raspberry Pi nur einen I2C Bus besitzt, wird immer dieser Bus übergeben.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public PotentiometerComponent(GroveAdapter groveAdapter)
            throws IOException, I2CFactory.UnsupportedBusNumberException {
        super(groveAdapter.getAdapter().getAnalogI2CAddress(), I2CBus.BUS_1);
        this.adapter = groveAdapter.getAdapter();
        ComponentLogger.logInfo("PotentiometerComponent: Potentiometer created for analog grove adapter");
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_wertebereich_setzen">7.7.2. Wertebereich setzen</h4>
<div class="paragraph">
<p>Der Grove Potentiometer liefert uns über den I2C Bus je nach eingestellter Position einen Wert zwischen 0 und 1000. Mittels der <code>setRange()</code> Funktion kann der Rückgabewert eingeschränkt werden. Erlaubt sind nur positive Integer dessen Differenz mindestens 10 beträgt und nicht grösser als 999 ist.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void setRange(int minValue, int maxValue) throws IllegalArgumentException {
        if (minValue &lt; 0 || maxValue &lt; 0) {
            IllegalArgumentException exception = new IllegalArgumentException(
                    "PotentiometerComponent: minValue and maxValue must be greater than 0");
            ComponentLogger.logError(exception.getMessage());
            throw exception;
        }

        int difference = maxValue - minValue;
        if (difference &lt; 10 || difference &gt; 1000) {
            IllegalArgumentException exception = new IllegalArgumentException(
                    "PotentiometerComponent: The difference between min and max value needs to be between 10 and 1000");
            ComponentLogger.logError(exception.getMessage());
            throw exception;
        }

        this.minValue = minValue;
        this.maxValue = maxValue;
        ComponentLogger.logInfo("PotentiometerComponent: Range set from " + minValue + " to " + maxValue);
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_value_lesen">7.7.3. Value lesen</h4>
<div class="paragraph">
<p>Der aktuelle Value des Potentiometers kann über die <code>getValue()</code> Funktion gelesen werden. Dazu verwenden wird die <code>readData()</code> Funktion unserer Basisklasse. Wir erwarten zwei Bytes auf dem Bus, welche über eine Hilfsfunktion in ein Integer Wert konvertiert werden. Der gelesenen Integer wird gemäss dem eingestellten Range zurückgegeben.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public int getValue() {
        byte[] bytes = readData((byte) adapter.getDeviceAddress(), (byte) 2);
        int readValue = getIntegerFromBytes(bytes[0], bytes[1]);
        if (minValue == 0 &amp;&amp; maxValue == 1000) {
            ComponentLogger.logInfo("PotentiometerComponent: Read a value of " + readValue);
            return readValue;
        } else {
            int difference = maxValue - minValue;
            if (readValue == 0) {
                return minValue;
            } else {
                double reducedValue = ((double) readValue / 1000) * difference;
                int roundedValue = (int) Math.round(minValue + reducedValue);
                ComponentLogger.logInfo("PotentiometerComponent: Read a value of " + readValue);
                return roundedValue;
            }
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dc_motor_2">7.8. DC Motor</h3>
<div class="paragraph">
<p>Gleichstrommotoren können mittels dem ihnen zur Verfügung gestellten Strom in ihrer Drehrichtung und Drehzahl reguliert werden. Diese Eigenschaft haben wir uns zu Nutzen gemacht, um unsere Component Klasse zu implementieren.</p>
</div>
<div class="sect3">
<h4 id="_motor_treiber_l293d">7.8.1. Motor Treiber L293D</h4>
<div class="paragraph">
<p>Der Chip erlaubt uns das Anpassen der Drehrichtung von Gleichstrommotoren mit einer Spannungsaufnahme von bis zu 36 Volt. Jede Seite des Chips erlaubt die Kontrolle eines Motors. Mit einem einzelnen L293D können also gleich zwei Motoren individuell angesteuert werden. Die folgende Abbildung zeigt das Pinout des Chips gefolgt von einer Beschreibung der einzelnen Pins.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://components101.com/l293d-pinout-features-datasheet"><img src="./assets/images/L293D_Pinout.png" alt="L293D Pinout" width="75% L293D Pinout"></a>
</div>
<div class="title">Figure 46. Pinout L293D</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 26. Beschreibung Pinout</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 57.1429%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Pin Nummer</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Pin Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Beschreibung</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable 1, 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aktiviert Input 1 und 2 wenn 5V Spannung anliegt.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kontrolliert Output 1. Muss mit einem Controller verbunden werden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Output 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Wird mit dem Motor 1 verbunden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ground</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ground</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Output 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Wird mit dem Motor 1 verbunden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kontrolliert Output 2. Muss mit einem Controller verbunden werden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vcc 2)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stromlieferant für den Motor / die Motoren. Positiver Pol der Stromquelle.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable 3. 4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aktiviert Input 3 und 4 wenn 5V Spannung anliegt.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input 3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kontrolliert Output 3. Muss mit einem Controller verbunden werden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Output 3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Wird mit dem Motor 2 verbunden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ground</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ground</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Output 4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Wird mit dem Motor 2 verbunden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input 4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kontrolliert Output 4. Muss mit einem Controller verbunden werden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vcc 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spannungsquelle für die Logik des Chips. Hier müssen 5V angelegt werden.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_drehrichtung_wechseln">7.8.2. Drehrichtung wechseln</h4>
<div class="paragraph">
<p>Wie bereits erwähnt, kann die Drehrichtung des Gleichstrommotors mittels Umkehrung der Polarität der Spannungsquelle gewechselt werden. Dies ist mittels des Motor Treibers L293D sehr einfach möglich. Die Polarität der Output Pins können wir mittels des Setzens der Input Pins beeinflussen. Die untere Tabelle zeigt, wie wir die verschiedenen Drehrichtungen umgesetzt haben. In unserem Beispiel verwenden wir die linke Seite des Chips. Enable 1, 2 ist also aktive, Enable 3, 4 ist inaktiv.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 27. Beschreibung Pinout</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Input 1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Input 2</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Motor dreht sich im Uhrzeigersinn.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Motor dreht sich im Gegenuhrzeigersinn.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Low</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Motor stoppt.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Das nachfolgenden Code Beispiele zeigt die <code>moveForwards()</code> sowie die <code>stop()</code> Funktion unserer Motor Component. Dabei wird unterschieden, ob der Motor zusätzlich über PWM gesteuert wird oder nicht. Dazu aber mehr im nächsten Unterkapitel.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void moveForwards() {
        if (isPwm) {
            moveForwards(100);
        } else {
            backwards.low();    //Input 2
            forwards.high();    //Input 1
            ComponentLogger.logInfo("MotorComponent: Motor is moving forwards with maximum power");
        }
    }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void stop() {
        if (isPwm) {
            pwmForwards.setPwm(0);
            pwmBackwards.setPwm(0);
        } else {
            forwards.low();     //Input 1
            backwards.low();    //Input 2
        }

        ComponentLogger.logInfo("MotorComponent: Motor stopped");
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_geschwindigkeit_anpassen">7.8.3. Geschwindigkeit anpassen</h4>
<div class="paragraph">
<p>Bei der Steuerung der Geschwindigkeit kann uns der Motor Treiber Chip nicht unterstützen. Dennoch kann die Geschwindigkeit des Motors manipuliert werden. Dies geschieht generell durch die Anpassung der am Motor anliegenden Spannung. Das Werkzeug unserer Wahl ist deshalb die <strong>P</strong>ulse <strong>W</strong>idth <strong>M</strong>odulation Funktion des Raspberry Pi.</p>
</div>
<div class="paragraph">
<p><strong>PWM</strong> lässt es zu, Pins gemäss einem gewissen Rhythmus zwischen High und Low wechseln zu lassen. Beispielsweise können wir einen Pin in einer Frequenz von 50 Hertz zwischen On und Off wechseln lassen. Zusätzlich können wir pro Puls bestimmen, wie lange der Pin High ist, bevor er zu Low wechselt. Dies nennen wir den Duty Cycle. Über den Duty Cycle steuern wir die am Motor anliegende Spannung und somit die Geschwindigkeit des Motors. Ein Duty Cycle von 0% entspricht dem Stillstand des Motors. 25% Duty Cycle entspricht einer Drehgeschwindigkeit von 25%. 100% Duty Cycle entspricht der vollen Leistung des Motors.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.elektronik-kompendium.de/sites/kom/0401111.htm"><img src="./assets/images/pwm.png" alt="pwm" width="75% PWM as a Graph"></a>
</div>
<div class="title">Figure 47. PWM als Grafik</div>
</div>
<div class="paragraph">
<p>In unserer Component Klasse steuern wir den Duty Cycle über die GPIO Klasse von Wiring Pi. Der gewünschte Duty Cycle wird über die <code>setPWM()</code> Funktion festgelegt. Die <code>rangeAdjustment</code> Variable wird benötigt, da Wiring Pi zwischen Software und Hardware PWM Pins unterscheidet.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Software:</strong> Duty Cycle zwischen 0 und 100</p>
</li>
<li>
<p><strong>Hardware:</strong> Duty Cycle zwischen 0 und 1024</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Der Raspberry Pi stellt zwei Hardware PWM Pins zur Verfügung. Dabei handelt es sich um die BCM Pins 12 und 13. Werden diese Pins an den Konstruktor übergeben, wird die Hardware PWM Funktionalität des Pi verwendet.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void moveForwards(int power) throws UnsupportedOperationException, IllegalArgumentException {
        if (!isPwm) {
            UnsupportedOperationException exception = new UnsupportedOperationException(
                    "MotorComponent: void moveForwards(int power) can only be used with hardware pwm pin. Please use void moveForwards() instead.");
            ComponentLogger.logError(exception.getMessage());
            throw exception;
        }

        if (power &lt; 0 || power &gt; 100) {
            IllegalArgumentException exception = new IllegalArgumentException(
                    "MotorComponent: Power must be between 0 and 100 percent");
            ComponentLogger.logError(exception.getMessage());
            throw exception;
        }

        pwmBackwards.setPwm(0);
        pwmForwards.setPwm((int) (power * rangeAdjustment));

        ComponentLogger.logInfo("MotorComponent: Motor is moving forwards at " + power + "%");
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_stepper_motor_2">7.9. Stepper Motor</h3>
<div class="paragraph">
<p>Schrittmotoren bestehen aus mehreren Spulen, welche um die in ihrer Mitte liegenden Welle angeordnet sind. Die Welle wird von einem Zylinder umschlossen, welcher abwechselnd mit positiven und negativen Polen versehen ist. Sobald durch eine Spule Strom fliesst, erzeugt diese ein Magnetfeld, nach welchem sich die Pole im Zylinder der Welle ausrichten. Somit kann die Welle gedreht werden.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://commons.wikimedia.org/w/index.php?curid=10011776"><img src="./assets/images/StepperMotor.gif" alt="StepperMotor" width="75% Single Stepping Stepper Motor"></a>
</div>
<div class="title">Figure 48. Stepper Motor unter Single Stepping</div>
</div>
<div class="paragraph">
<p>Bei den meisten Schrittmotoren kommt zusätzlich zur Welle noch ein Getriebe zum Einsatz, welches durch seine Übersetzung den Drehwinkel pro Schritt weiter verkleinert. Beim weit verbreiteten Stepper Motor 28BYJ-48 ist zum Beispiel ein 1/64 Getriebe verbaut. Jeder Schritt der Welle resultiert bei diesem Motor um eine um 64 verkleinerte Drehung.</p>
</div>
<div class="paragraph">
<p>Mit der von uns zur Verfügung gestellten Component Klasse können vier Phasen Schrittmotoren gesteuert werden. Das jeweilige Getriebe hat keinen Einfluss auf die Funktionalität unserer Bibliothek.</p>
</div>
<div class="sect3">
<h4 id="_single_stepping">7.9.1. Single Stepping</h4>
<div class="paragraph">
<p>Beim Single Stepping wird jeweils nur eine Spule im Gehäuse des Motors unter Strom gesetzt. Die Welle des Motors richtet sich also immer genau nach der momentan aktiven Spule aus.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.rs-online.com/designspark/stepper-motors-and-drives-what-is-full-step-half-step-and-microstepping"><img src="./assets/images/single_stepping.jpg" alt="single stepping" width="75% Single Stepping"></a>
</div>
<div class="title">Figure 49. Single Stepping</div>
</div>
<div class="paragraph">
<p>Die folgende Tabelle zeigt pro Schritt auf, wie die Spulen gesetzt werden müssen.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 28. Single Stepping</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 3</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 4</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Magnet 1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Magnet 2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Magnet 3</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Magnet 4</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Implementation des Modus als Byte Array in unserer Component Klasse:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    private final byte[] single_step = new byte[] { 0b1000, 0b0100, 0b0010, 0b0001 };</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_double_stepping">7.9.2. Double Stepping</h4>
<div class="paragraph">
<p>Unter Verwendung des Double Stepping werden immer zwei Spulen simultan unter Strom gesetzt. Dies führt dazu, dass sich die Welle gemäss dem entstehenden Magnetfeld zwischen den zwei Spulen ausrichtet. Die sich überschneidenden Magnetfelder sind stärker als ein einzelnes Magnetfeld, weshalb der Schrittmotor unter diesem Modus mit grösserer Kraft arbeitet. Da allerdings zwei Spulen gleichzeitig mit Strom beliefert werden müssen, verdoppelt sich der Stromverbrauch im Vergleich zum Single Stepping.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.rs-online.com/designspark/stepper-motors-and-drives-what-is-full-step-half-step-and-microstepping"><img src="./assets/images/double_stepping.jpg" alt="double stepping" width="75% Double Stepping"></a>
</div>
<div class="title">Figure 50. Double Stepping</div>
</div>
<div class="paragraph">
<p>Die folgende Tabelle zeigt pro Schritt auf, wie die Spulen gesetzt werden müssen.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 29. Double Stepping</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 3</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 4</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Magnet 1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Magnet 2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Magnet 3</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Magnet 4</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Implementation des Modus als Byte Array in unserer Component Klasse:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    private final byte[] double_step = new byte[] { 0b1100, 0b0110, 0b0011, 0b1001 };</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_half_stepping">7.9.3. Half Stepping</h4>
<div class="paragraph">
<p>Im Gegensatz zu den anderen Modi agiert Half Stepping in acht Schritten. Somit kann die Position des Motors genauer bestimmt werden als in den anderen Modi. Half Stepping kombiniert Single Stepping und Dual Stepping. Dies führt dazu, dass der Motor nicht immer gleich viel Kraft hat. Bei jedem zweiten Schritt ist jeweils nur eine Spule aktiv.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/half_stepping.jpg" alt="half stepping" width="75% Half Stepping">
</div>
<div class="title">Figure 51. Half Stepping</div>
</div>
<div class="paragraph">
<p>Die folgende Tabelle zeigt pro Schritt auf, wie die Spulen gesetzt werden müssen.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 30. Half Stepping</caption>
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1111%;">
<col style="width: 11.1112%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 3</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 4</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 5</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 6</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 7</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Step 8</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Magnet 1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Magnet 2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Magnet 3</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Magnet 4</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Implementation des Modus als Byte Array in unserer Component Klasse:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    private final byte[] half_step = new byte[] { 0b1000, 0b1100, 0b0100, 0b0110, 0b0010, 0b0011, 0b0001, 0b1001 };</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_motor_drehen">7.9.4. Motor drehen</h4>
<div class="paragraph">
<p>Die schrittweise Drehung des Motors haben wir in einem for-Loop implementier. Die Variable <code>element</code> enthält die zu einstellende Position des aktuell auszuführenden Schritts. Dies könnte zum Beispiel der Wert <code>0b0100</code> sein. Dieser entspricht dem 2. Step im Single Stepping.</p>
</div>
<div class="paragraph">
<p>In einem nächsten Schritt müssen die einzelnen Pins gemäss dem aktuellen <code>element</code> gesetzt werden. Dazu nutzen wir den Bitweise Operator und verschieben die Bits gemäss dem aktuellen Pin. Durch die Addition von <code>0b0001</code> eliminieren wir alle überflüssigen Einsen. Nun können wir prüfen, ob das Byte dem Wert <code>1</code> entspricht. Ist dies der Fall, setzen wir den Pin auf <code>HIGH</code>.</p>
</div>
<div class="paragraph">
<p>Zu guter Letzt setzen wir noch die lokale Variabel <code>currentPosition</code>. Diese ist für Richtungsänderungen und das saubere Laufen des Motors relevant.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    private void step(int steps, boolean stepForwards) throws InterruptedException {
        if (stepForwards != lastDirectionForward) {
            shiftCurrentPosition();
            lastDirectionForward = stepForwards;
        }

        for (int i = 0; i &lt; steps; i++) {
            byte element = getElement(i, stepForwards);
            digitalOut1.setState((element &gt;&gt; 0 &amp; 0b0001) == 1 ? PinState.HIGH : PinState.LOW);
            digitalOut2.setState((element &gt;&gt; 1 &amp; 0b0001) == 1 ? PinState.HIGH : PinState.LOW);
            digitalOut3.setState((element &gt;&gt; 2 &amp; 0b0001) == 1 ? PinState.HIGH : PinState.LOW);
            digitalOut4.setState((element &gt;&gt; 3 &amp; 0b0001) == 1 ? PinState.HIGH : PinState.LOW);
            Thread.sleep(stepDelay);
        }

        setCurrentPosition(steps);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die <code>getElement()</code> Funktion gibt das aktuelle Element im Array des aktuellen Modus zurück. Dabei wir auch die aktuelle Drehrichtung des Motors berücksichtigt. Die Variabel <code>currentPosition</code> enthält die Position im Array, welcher der Motor vor dem nächsten Drehbefehl hatte. So stellen wir sicher, dass der Motor zwischen zwei einzelnen Befehlen niemals ruckelt (einzelne Steps überspringt).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    private byte getElement(int stepNumber, boolean forwards) {
        int elementPosition = stepNumber + currentPosition;
        switch (mode) {
        case HALF_STEP:
            return forwards ?
                    half_step[Math.floorMod(elementPosition, half_step.length)] :
                    rev_half_step[Math.floorMod(elementPosition, rev_half_step.length)];
        case SINGLE_STEP:
            return forwards ?
                    single_step[Math.floorMod(elementPosition, single_step.length)] :
                    rev_single_step[Math.floorMod(elementPosition, rev_single_step.length)];
        case DOUBLE_STEP:
            return forwards ?
                    double_step[Math.floorMod(elementPosition, double_step.length)] :
                    rev_double_step[Math.floorMod(elementPosition, rev_double_step.length)];
        default:
            IllegalArgumentException exception = new IllegalArgumentException("StepperMotorMode is invalid.");
            ComponentLogger.logError(exception.getMessage());
            throw exception;
        }
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_drehrichtung_ändern">7.9.5. Drehrichtung ändern</h4>
<div class="paragraph">
<p>In der lokalen Variable <code>currentPosition</code> speichern wir die aktuelle Position des Motors im Array des aktuellen Modi. Beim Drehen des Motors müssen wir die Variable neu berechnen, da wir beim Ändern der Drehrichtung einen seperaten Array verwenden. Dieser entspricht dem gespiegelten original Array des jeweiligen Modus.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    private final byte[] half_step = new byte[] { 0b1000, 0b1100, 0b0100, 0b0110, 0b0010, 0b0011, 0b0001, 0b1001 };
    private final byte[] rev_half_step = new byte[] { 0b1001, 0b0001, 0b0011, 0b0010, 0b0110, 0b0100, 0b1100, 0b1000 };</code></pre>
</div>
</div>
<div class="paragraph">
<p>Die neue Position entspricht der Länge des Array des aktuellen Modus reduziert um 1 minus der aktuellen Position im Array.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    private void shiftCurrentPosition() {
        switch (mode) {
        case HALF_STEP:
            currentPosition = half_step.length - 1 - currentPosition;
            break;
        case SINGLE_STEP:
            currentPosition = single_step.length - 1 - currentPosition;
            break;
        case DOUBLE_STEP:
            currentPosition = double_step.length - 1 - currentPosition;
            break;
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_servo_motor_2">7.10. Servo Motor</h3>
<div class="paragraph">
<p>Mit Servo Motoren lassen sich Winkel präzise einstellen und halten. Gängige Servo Motoren erlauben das Einstellen von Winkeln zwischen 0 und 180 Grad. Der Wechsel zwischen einzelnen Positionen erfolgt sehr zügig. Gesteuert wird die Position der Welle über ein PWM Signal. Unsere Klasse unterstützt dabei die Hardware PWM Pins des Raspberry Pi. Software PWM Signale unterstützen wir bewusst nicht. Diese sind meist zu ungenau und sind deshalb nicht für die Steuerung von Servo Motoren geeignet.</p>
</div>
<div class="sect3">
<h4 id="_steuerung_über_pwm">7.10.1. Steuerung über PWM</h4>
<div class="paragraph">
<p>Die Mehrheit aller Servo Motoren benötigt für dessen Steuerung einen 50 Hertz PWM Puls, was einem Zyklus alle 20 Millisekunden entspricht. Mittels WiringPi können wir die gewünschte Frequenz ziemlich einfach einstellen.</p>
</div>
<div class="paragraph">
<p>Der Raspberry Pi Prozessor liefert uns eine Basis-Frequenz von 19.2 MHZ. Diese müssen wir nun auf 50 Hertz reduzierten. Dies erreichen wir über die folgenden Einstellungen.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">        Gpio.pwmSetMode(Gpio.PWM_MODE_MS);
        Gpio.pwmSetClock(192);
        Gpio.pwmSetRange(2000);

        ComponentLogger.logInfo("ServoMotorComponent: ServoMotor created for GPIO pin " + pin.getPin().getAddress()
                + " with a minimal pulse length of " + pulseMin + " and a maximal pulse length of " + pulseMax);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Durch die getätigten Einstellungen errechnet der Pi die PWM Frequenz 19.2 MHZ / 192 / 2000 = 50 HZ. Mit dieser Frequenz können wir nun weiterarbeiten.</p>
</div>
<div class="paragraph">
<p>Servo Motoren lassen sich nun über die sogenannte Pulslänge steuern. Die Pulslänge enspricht der HIGH Time eines einzelnen Pulses. Die meisten Mini und Micro Servo Motoren können über Pulslängen von 500 Mikro Sekunden bis 2400 Mikro Sekunden positioniert werden. Die genauen Werte können jedoch im Data Sheet des jeweiligen Servos gefunden werden. Kleinere Pulslängen entsprechen dabei kleineren Winkeln. Die Position verhält sich immer linear zur Pulslänge.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 31. Beispiele Pulslänge</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Winkel in Grad</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Pulslänge in Mikro Sekunden</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">500</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">45</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">975</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">90</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1450</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">135</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1925</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">180</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2400</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Leider können wir die Pulslänge nicht direkt in Mikro Sekunden an den Hardware PWM Pin weitergeben. Wir müssen die Value zuerst um den Faktor 10 reduzieren. WiringPi erlaubt nämlich nur das Setzen von Werten in einer Range von 0 bis 1024.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void setPosition(int pulse) throws IllegalArgumentException {
        if (pulse &lt; pulseMin || pulse &gt; pulseMax) {
            IllegalArgumentException exception = new IllegalArgumentException(
                    "ServoMotorComponent: Please provide a value in the range pulseMin to pulseMax");
            ComponentLogger.logError(exception.getMessage());
            throw exception;
        }

        setPwm(pulse);
        ComponentLogger.logInfo("ServoMotorComponent: set the position to pulse " + pulse);
    }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    private void setPwm(int pwm) {
        pin.setPwm(Math.round(pwm / 10));
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_winkel_setzen">7.10.2. Winkel setzen</h4>
<div class="paragraph">
<p>Unsere Hilfsklasse untersützt das Setzen von gewünschen Servo Motor Positionen via gewünschtem Zielwinkel. Mit der Funktion <code>setPositionDegrees()</code> können Winkel auf einen Grad genau gesetzt werden, sofern der verwendete Servo dies ebenfalls unterstützt. Unterstützt der verwendete Servo dies nicht, können wir den Winkel nicht garantieren.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void setPositionDegrees(int degree) throws IllegalArgumentException {
        if (degree &lt; 0 || degree &gt; maxDegrees) {
            IllegalArgumentException exception = new IllegalArgumentException(
                    "ServoMotorComponent: Please provide a value in the range 0 to maxDegrees");
            ComponentLogger.logError(exception.getMessage());
            throw exception;
        }

        double stepSize = ((double) maxDegrees / (pulseMax - pulseMin));
        int pulse = pulseMin + (int) Math.round(degree / stepSize);
        setPwm(pulse);
        ComponentLogger.logInfo(
                "ServoMotorComponent: Set the position to degrees " + degree + " which is a pulse of " + pulse);
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_grove_serial_camera_2">7.11. Grove Serial Camera</h3>
<div class="paragraph">
<p>Die Grove Serial Camera ist eines der komplexeren Devices, welches von unserer Library unterstützt wird. Zur Kommunikation über den Serial Bus wird ein spezielles Protokoll eingesetzt. In den folgenden Unterkapiteln finden Sie weitere Informationen zu jenem Protokoll und unserer Implementation davon.</p>
</div>
<div class="sect3">
<h4 id="_protokoll">7.11.1. Protokoll</h4>
<div class="paragraph">
<p>Die Datenübermittlung zwischen Kamera und Pi erfolgt über den Serial Bus und das OV528 Protokoll. Die einzelnen Kommandos umfassen jeweils 6 Bytes, welche zusammen als Paket übermittelt werden. Das nachfolgende Beispiel zeigt das SYNC Kommando, welches jeweils zu Beginn der Kommunikation vom Pi ausgesendet wird. Folgende Bytes werden übermittelt: AA0D00000000h.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://files.seeedstudio.com/wiki/Grove-Serial_Camera_Kit/res/cj-ov528_protocol.pdf"><img src="./assets/images/Grove_Serial_Camera_SYNC_Command.png" alt="500" width="500" height="Grove Serial Camera SYNC"></a>
</div>
<div class="title">Figure 52. SYNC Kommando</div>
</div>
</div>
<div class="sect3">
<h4 id="_verbindung_mit_der_kamera_aufbauen">7.11.2. Verbindung mit der Kamera aufbauen</h4>
<div class="paragraph">
<p>Bevor Befehle an die Kamera gesendet werden können, muss eine Verbindung zwischen Kamera und Raspberry Pi etabliert werden. Dazu wird vom Host mehrmals ein SYNC Kommando auf den Serial Port geschrieben und auf eine Antwort von der Kamera gewartet. Durchschnittlich antwortet die Kamera nach 25 SYNC Kommandos mit einem ACK (AA0E0Dxx0000h). Auf die Empfangsbestätigung folgt das Kommando, welches die Kamera bestätigt. In diesem Fall das SYNC Kommando (AA0D00000000h). Gibt die Kamera nach 60 SYNC Befehlen noch immer keine Antwort, kann davon ausgegangen werden, dass etwas mit der Verkabelung der Kamera nicht stimmt oder der Controller der Kamera defekt ist.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://files.seeedstudio.com/wiki/Grove-Serial_Camera_Kit/res/cj-ov528_protocol.pdf"><img src="./assets/images/Grove_Serial_Camera_Initialisation.png" alt="500" width="500" height="Grove Serial Camera Connection"></a>
</div>
<div class="title">Figure 53. Verbindungsaufbau</div>
</div>
<div class="paragraph">
<p>In unserer Java Klasse haben wir den Verbindungsaufbau in einer eigenen Funktion realisiert, welche vom jeweiligen Konstruktor aufgerufen wird. In einer While-Schlaufe wird das SYNC Kommando solange an die Kamera gesendet, bis diese eine Antwort auf den Serial Bus geschrieben hat. Ist dies nach 60 Versuchen nicht der Fall, wird die Initialisierung mit einem Fehler abgebrochen. Hat die Kamera eine Antwort gesendet, wird diese auf Ihre Korrektheit überprüft. Die ersten sechs Bytes müssen dem ACK Kommando entsprechen (AA0E0Dxx0000h). Bei den nächsten sechs Bytes muss es sich um das SYNC Kommando handeln (AA0D00000000h). Sofern dies der Fall ist, war der Verbindungsaufbau erfolgreich. Die Kamera ist nun bereit für die Entgegennahme von weiteren Befehlen.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    private void initializeSerialBusCommunication() throws InterruptedException, IOException {
        try {
            int tryCount = 0;
            byte[] syncCommand = { (byte) 0xaa, 0x0d, 0x00, 0x00, 0x00, 0x00 };
            byte[] ackCommand = { (byte) 0xaa, 0x0e, 0x0d, 0x00, 0x00, 0x00 };

            ComponentLogger.logInfo("SerialCameraComponent: Initializing communication with the camera");

            while (serial.available() == 0 &amp;&amp; tryCount &lt; syncRetryCount) {
                serial.write(syncCommand);
                tryCount++;
                Thread.sleep(100);
            }

            if (tryCount &gt;= syncRetryCount) {
                IOException exception = new IOException(
                        "SerialCameraComponent: Tried to sync with camera for " + tryCount + " without success");
                ComponentLogger.logError(exception.getMessage());
                throw exception;
            }

            ComponentLogger.logInfo("SerialCameraComponent: Camera responded after " + tryCount + " requests");
            byte[] bytes = serial.read(6);
            clearDataFromSerialInput();

            if (bytes[0] == 0xaa &amp;&amp; bytes[1] == 0x0e &amp;&amp; bytes[2] == 0x0d &amp;&amp; bytes[4] == 0x00 &amp;&amp; bytes[5] == 0x00) {
                ComponentLogger.logInfo("SerialCameraComponent: Received response is a valid acknowledgement");
                ComponentLogger.logInfo("SerialCameraComponent: Waiting for sync from camera");
                bytes = serial.read(6);

                if (bytes[0] == 0xaa &amp;&amp; bytes[1] == 0x0d &amp;&amp; bytes[2] == 0x00 &amp;&amp; bytes[3] == 0x00 &amp;&amp; bytes[4] == 0x00
                        &amp;&amp; bytes[5] == 0x00) {
                    ComponentLogger.logInfo("SerialCameraComponent: Received sync from the camera");
                    ComponentLogger.logInfo("SerialCameraComponent: Sending sync acknowledgement to camera");
                    serial.write(ackCommand);
                    ComponentLogger.logInfo("SerialCameraComponent: Serial bus communication ready");
                }
            }

            clearDataFromSerialInput();
        } catch (Exception ex) {
            ComponentLogger.logError("SerialCameraComponent: " + ex.getMessage());
            throw ex;
        }
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_jpeg_foto_anfordern">7.11.3. JPEG Foto anfordern</h4>
<div class="paragraph">
<p>Nach dem erfolgreichen Verbindungsaufbau ist die Kamera bereit für das Schiessen von Bildern. Unsere Implementation stellt Bilder im JPEG Format in der Auflösung 640 x 480 zur Verfügung. Hierbei handelt es sich um die maximale Auflösung der Kamera. Theoretisch können auch Bilder in anderen Grössen und Formaten von der Kamera angefordert werden. Diese Formate werden von uns jedoch nicht unterstützt.</p>
</div>
<div class="paragraph">
<p>Um ein Bild von der Kamera zu erhalten, sind mehrere einzelne Schritte, Befehle und Bestätigungen nötig. Diese sind im folgenden Diagramm ersichtlich.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://files.seeedstudio.com/wiki/Grove-Serial_Camera_Kit/res/cj-ov528_protocol.pdf"><img src="./assets/images/Grove_Serial_Camera_Get_Picture.png" alt="500" width="500" height="Grove Serial Camera Get Picture"></a>
</div>
<div class="title">Figure 54. Ablauf der Bildanforderung</div>
</div>
</div>
<div class="sect3">
<h4 id="_bildgrösser_ermitteln">7.11.4. Bildgrösser ermitteln</h4>
<div class="paragraph">
<p>Zur Ermittlung der Bildgrösse wird die gewünschte Paketgrösse der einzelnen Pakete benötigt. Die Paketgrösse kann vom Anwender im Bereich von 16 bis 2048 Bits definiert werden. Die Default Paketgrösse ist 512 Bits.</p>
</div>
<div class="paragraph">
<p>Als erster Schritt wird die zuvor definierte gewünschte Paketgrösse an die Kamera gesendet und es wird auf eine Empfangsbestätigung der Kamera gewartet.</p>
</div>
<div class="paragraph">
<p>Anschliessend wird das Snapshot Kommando an die Kamera gesendet. Dieses Kommando bereitet die Kamera auf das Erzeugen eines Bildes vor. Auch hier wird wieder auf eine Empfangsbestätigung der Kamera gewartet.</p>
</div>
<div class="paragraph">
<p>Zu guter Letzt wird der Befehl zur JPEG Generierung an die Kamera übermittelt. Die Kamera antwortet auf dieses Kommando mit einer Empfangsbestätigung gefolgt von der Anzahl Bytes des Bildes, welches geschossen wurde.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    private int getPictureLengthFromCamera() throws IOException, InterruptedException {
        int pictureLength = 0;

        byte[] setPackageSizeCommand = { (byte) 0xaa, 0x06, 0x08, (byte) (packageSize &amp; 0xff),
                (byte) ((packageSize &gt;&gt; 8) &amp; 0xff), 0x00 };
        byte[] snapshotCommand = { (byte) 0xaa, 0x05, 0x00, 0x00, 0x00, 0x00 };
        byte[] getPictureCommand = { (byte) 0xaa, 0x04, 0x01, 0x00, 0x00, 0x00 };

        ComponentLogger.logInfo("SerialCameraComponent: Sending the desired package size to the camera");
        serial.write(setPackageSizeCommand);

        while (serial.available() &lt; 6) {
            Thread.sleep(10);
        }

        ComponentLogger.logInfo("SerialCameraComponent: Received a response from the camera");
        byte[] bytes = serial.read(6);

        if (bytes[0] == (byte) 0xaa &amp;&amp; bytes[1] == (byte) 0x0e &amp;&amp; bytes[2] == (byte) 0x06 &amp;&amp; bytes[4] == (byte) 0x00
                &amp;&amp; bytes[5] == (byte) 0x00) {
            ComponentLogger.logInfo("SerialCameraComponent: Response was a valid package size acknowledgement");
        }

        ComponentLogger.logInfo("SerialCameraComponent: Sending snapshot command");
        serial.write(snapshotCommand);

        while (serial.available() &lt; 6) {
            Thread.sleep(10);
        }

        ComponentLogger.logInfo("SerialCameraComponent: Received a response from the camera");
        bytes = serial.read(6);

        if (bytes[0] == (byte) 0xaa &amp;&amp; bytes[1] == (byte) 0x0e &amp;&amp; bytes[2] == (byte) 0x05 &amp;&amp; bytes[4] == (byte) 0x00
                &amp;&amp; bytes[5] == (byte) 0x00) {
            ComponentLogger.logInfo("SerialCameraComponent: Response was a valid snapshot acknowledgement");
        }

        ComponentLogger.logInfo("SerialCameraComponent: Sending get picture length command");
        serial.write(getPictureCommand);

        while (serial.available() &lt; 6) {
            Thread.sleep(10);
        }

        ComponentLogger.logInfo("SerialCameraComponent: Received a response from the camera");
        bytes = serial.read(6);

        if (bytes[0] == (byte) 0xaa &amp;&amp; bytes[1] == (byte) 0x0e &amp;&amp; bytes[2] == (byte) 0x04 &amp;&amp; bytes[4] == (byte) 0x00
                &amp;&amp; bytes[5] == (byte) 0x00) {
            ComponentLogger.logInfo("SerialCameraComponent: Response was a valid picture length acknowledgement");
            ComponentLogger.logInfo("SerialCameraComponent: Reading the next 6 bytes to get the picture length");
            bytes = serial.read(6);

            if (bytes[0] == (byte) 0xaa &amp;&amp; bytes[1] == 0x0a &amp;&amp; bytes[2] == 0x01) {
                pictureLength = (int) bytes[3] + (bytes[4] &lt;&lt; 8) + (bytes[5] &lt;&lt; 16);
                ComponentLogger.logInfo("SerialCameraComponent: Picture length is: " + pictureLength);
            }
        }

        return pictureLength;
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_bild_pakete_empfangen">7.11.5. Bild Pakete empfangen</h4>
<div class="paragraph">
<p>Nachdem die Bildgrösse von der Kamera ermittelt wurde, kann der Host Paket für Paket von der Kamera über den Serial Bus anfordern. Wir fordern solange Pakete von der Kamera an, bis wir das letzte Paket von der Kamera erhalten haben. Das letzte Paket erkennen wir anhand der letzten zwei Bytes. Handelt es sich bei diesen um 0xFF gefolgt von 0xD9, wurde das komplette JPEG übermittelt. Bei den zwei Bytes handelt es sich nämlich um den Footer eines jeden JPEGs.</p>
</div>
<div class="paragraph">
<p>Da es bei der Übermittlung von Paketen immer zu Fehlern kommen kann, stellt das OV528 Protokoll einen Kontrollmechanismus zur Verfügung, über welchen Fehler identifiziert werden können. Bei den zwei letzten Bytes eines jeden Pakets handelt es sich um eine Prüfsumme, mit welchen die übermittelten Bilddaten überprüft werden können. Die Prüfsumme muss exakt der Summe der einzelnen übermittelten Bytes entsprechen. Ist dies der Fall, fordern wir das nächste Paket von der Kamera an. Stimmt die Prüfsumme jedoch nicht mit der Summe aller Bild-Bytes überein, fordern wir das fehlerhafte Paket erneut von der Kamera an. Damit kann sichergestellt werden, dass das erhaltene Bild immer fehlerfrei ist.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    private byte[] getJpgBytes(int pictureLength) throws IOException, InterruptedException {
        byte[] receiveDataPackageCommand = { (byte) 0xaa, 0x0e, 0x00, 0x00, 0x00, 0x00 };
        byte[] ackPackageEndCommand = { (byte) 0xaa, 0x0e, 0x00, 0x00, (byte) 0xf0, (byte) 0xF0 };

        int successCount = 0;
        boolean pictureEnd = false;
        ByteArrayOutputStream camStream = new ByteArrayOutputStream();
        ByteBuffer imageBuffer = ByteBuffer.allocate(packageSize);

        while (!pictureEnd) {
            receiveDataPackageCommand[4] = (byte) successCount;
            receiveDataPackageCommand[5] = (byte) (successCount &gt;&gt; 8);

            serial.write(receiveDataPackageCommand);

            while (imageBuffer.position() &lt; packageSize &amp;&amp; !pictureEnd) {
                pictureEnd = lastPackageComplete(imageBuffer);
                if (!pictureEnd) {
                    Thread.sleep(10);
                    imageBuffer.put(serial.read());
                }
            }

            byte[] receivedData = imageBuffer.array();
            imageBuffer.position(0);
            byte calculatedCheckSum = getCheckSum(receivedData);
            byte receivedCheckSum = receivedData[receivedData.length - 1 + lowCheckSumBitPosition];

            if (calculatedCheckSum == receivedCheckSum || pictureEnd) {
                int byteCount = getIntegerFromBytes(receivedData[lowDataSizeBit], receivedData[highDataSizeBit]);
                lastWrittenByte = receivedData[receivedData.length - 3];
                camStream.write(receivedData, 4, byteCount);
                ComponentLogger.logInfo("SerialCameraComponent: Package at " + successCount + " successfully handled");
                successCount++;
            } else {
                ComponentLogger.logInfo("SerialCameraComponent: Calculated check sum is " + calculatedCheckSum);
                ComponentLogger.logInfo("SerialCameraComponent: Received check sum is " + receivedCheckSum);
                ComponentLogger.logInfo("SerialCameraComponent: Package error at package " + successCount);
                ComponentLogger.logInfo("SerialCameraComponent:  =&gt; retry");
            }
        }

        ComponentLogger.logInfo("SerialCameraComponent: Read a total of " + camStream.size() + " bytes");
        ComponentLogger.logInfo("SerialCameraComponent: Pure picture length was " + pictureLength);
        ComponentLogger.logInfo("SerialCameraComponent: Sending package end acknowledgement to camera");
        serial.write(ackPackageEndCommand);

        return camStream.toByteArray();
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_raspberry_pi_camera_2">7.12. Raspberry Pi Camera</h3>
<div class="paragraph">
<p>Die Raspberry Pi Camera enthält in Raspbian vier Applikationen, welche man vom Terminal aus verwenden kann.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>raspistill</code> und <code>raspiyuv</code> für die Bildaufnahme</p>
</li>
<li>
<p><code>raspivid</code> und <code>raspividyuv</code> für die Videoaufnahme</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>raspiyuv</code> und <code>raspividyuv</code> verwenden keinen Encoder, sondern senden ihr YUV (Ein Farbmodell wie RBG) direkt von der Kamera an ein File. Diese beiden Applikationen werden nicht unterstützt von der <code>RaspberryPiCameraComponent</code>. Die Device Klasse verwendet intern nur <code>raspistill</code> und <code>raspivid</code>.</p>
</div>
<div class="paragraph">
<p>In den folgenden Unterkapiteln wird auf die Terminal Befehle für <code>raspistill</code> und <code>raspivid</code> eingegangen, falls es direkt verwendet wird. Ausserdem wird auf die Funktionalität der <code>RaspberryPiCameraComponent</code> eingegangen.</p>
</div>
<div class="sect3">
<h4 id="_terminal_befehle">7.12.1. Terminal Befehle</h4>
<div class="paragraph">
<p>Hier sind einige Beispiele für Standardbefehle mit <code>raspistill</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bildaufnahme (default)<br>
<code>raspistill -o image.jpg</code></p>
</li>
<li>
<p>Aufnahme in anderen Formaten z. B: jpg, bmp, gif und png<br>
<code>raspistill –e png -o image.png</code></p>
</li>
<li>
<p>Zeitverzögerte Aufnahme mit -t <em>&lt;Millisekunden&gt;</em><br>
<code>raspistill  -t 2000 -o image.jpg</code></p>
</li>
<li>
<p>Aufnahme in einer anderen Auflösung<br>
<code>raspistill  -w 640 -h 480 -o image.jpg</code></p>
</li>
<li>
<p>Aufnahme in einer niedrigeren Qualität (In Prozent)
<code>raspistill -q 50 -o image.jpg</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Hier sind einige Beispiele für Standardbefehle mit <code>raspivid</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>15 Sekunden Video mit default Einstellungen (1080p, also 1920 x 1080 und 30 fps)<br>
<code>raspivid  -t 15000 -o video.h264</code></p>
</li>
<li>
<p>15 Sekunden Video in 720p (1280 x 720)<br>
<code>raspivid -t 15000 -w 1280 -h 720 -o video.h264</code></p>
</li>
<li>
<p>15 Sekunden Video mit 10 Frames/Sekunde
<code>raspivid -t 10000 -f 10 -o video.h264</code></p>
</li>
<li>
<p>15-Sekunden-Video mit 3 MBits/s<br>
<code>raspivid -t 15000 -b 3000000 -o video.h264</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Für mehr Informationen können Sie die Befehle in der offiziellen Dokumentation anschauen:<br>
<a href="https://www.raspberrypi.org/documentation/raspbian/applications/camera.md">Raspberry Pi Camera - Terminal Befehle</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_java_library_für_bildaufnahme">7.12.2. Java Library für Bildaufnahme</h4>
<div class="paragraph">
<p>Es gibt zwei prominente java Libraries, welche für die Bildaufnahme verwendet werden können.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/Hopding/JRPiCam">JRPiCam</a>: Verwendet eine Builder-Klasse, um die Befehle für <code>raspistill</code> aufzubauen und führt diese dann im Hintergrund mit einem Java Process aus. Es ist im Prinzip ein Wrapper für die native Applikation <code>raspistill</code>.</p>
</li>
<li>
<p><a href="https://github.com/caprica/picam">PiCam</a> <code>raspistill</code> benutzt eine native MMAL library für die Kamera, welche von picam direkt verwendet wird. Das macht picam wesentlich schneller als JRPiCam, da es kein externes Programm verwendet.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Für die Device-Klasse, welche wir zur Verfügung stellen, wird PiCam verwendet, da die hohe Geschwindigkeit ein immenser Vorteil ist. Falls aber Studierende die JRPiCam-Library verwenden möchten, dann werden sie auch hierfür ein Bespiel unter den RaspberryPi Camera Beispielen finden.</p>
</div>
</div>
<div class="sect3">
<h4 id="_bildaufnahme">7.12.3. Bildaufnahme</h4>
<div class="paragraph">
<p>Für die Bildaufnahme mit der <code>RaspberrPiCameraComponent</code> muss man sich zuerst ein <code>CameraConfiguration</code>-Objekt erstellen, welches praktisch den Befehl wiederspiegelt, welchen man im Terminal manuell eingeben kann.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">//Create Configuration object with builder approach
CameraConfiguration config = cameraConfiguration()
    .width(1920)
    .height(1080)
    .encoding(Encoding.JPEG)
    .quality(85)
    .rotation(180);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wenn man dann dieses Objekt der <code>RaspberrPiCameraComponent</code> im Konstruktor übergibt, dann kann man mit der Methode <code>takeStill</code> Bilder aufnehmen, wie im wenn man die PiCam-Library direkt verwendet.</p>
</div>
</div>
<div class="sect3">
<h4 id="_videoaufnahme">7.12.4. Videoaufnahme</h4>
<div class="paragraph">
<p>Für die Videoaufnahme gibt es eine Builder-Klasse, welche vom Syntax und der Verwendung her ähnlich aufgebaut ist, wie die <code>CameraConfiguration</code> Klasse von PiCam.</p>
</div>
<div class="paragraph">
<p>So wie mit der <code>CameraConfiguration</code> von der PiCam ein <code>raspistill</code> Befehl aufgebaut wird, wird mit der <code>RaspiVidConfiguration</code> dann ein <code>raspivid</code> Befehl aufgebaut.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">//configuration for videos using raspivid with builder object
RaspiVidConfiguration vidConfig = new RaspiVidConfiguration()
    .verticalflip()
    .previewOff()
    .time(15000);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Wenn das Objekt dann der <code>RaspberryPiCameraComponent</code> übergeben wird im Konstruktor, dann wird mit der Methode <code>takevid</code> ein Video aufgenommen. Dabei wird der Befehl der Konfigurationsklasse extrahiert und als Java Process ausgeführt.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    public void takeVid(String outputPath) {
        ComponentLogger.logInfo("RaspberryPiCameraComponent: Taking video to the path: " + outputPath);

        if (!isRaspiVidAvailable) {
            ExceptionInInitializerError ex = new ExceptionInInitializerError("RaspiVid has to be initialised with the Configuration for taking videos");
            ComponentLogger.logError("RaspberryPiCameraComponent: " + ex.getMessage());
            throw ex;
        }
        try {
            raspiVidConfiguration.output(outputPath);
            String command = raspiVidConfiguration.toString();

            //This will just run in the background and save the video in a file
            Process p = Runtime.getRuntime().exec(command);
            p.waitFor();
            Thread.sleep(raspiVidConfiguration.getTime());

            p.destroy();
            if (p.isAlive())
                p.destroyForcibly();

        } catch (IOException | InterruptedException ieo) {
            ComponentLogger.logError("RaspberryPiCameraComponent: Error while taking video: " + ieo.getMessage());
        }
    }</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_literaturverzeichnis">Literaturverzeichnis</h2>
<div class="sectionbody">
<div class="ulist bibliography">
<ul class="bibliography">
<li>
<p><a id="RaspberryPi1"></a>[1] Raspberry Pi Foundation. What is a Raspberry Pi? In: raspberrypi.org [
<a href="https://www.raspberrypi.org/help/what-%20is-a-raspberry-pi/" class="bare">https://www.raspberrypi.org/help/what-%20is-a-raspberry-pi/</a>; 09.08.2020]</p>
</li>
<li>
<p><a id="RaspberryPi2"></a>[2] Elektronik Kompendium. Raspberry Pi: GPIO - General Purpose Input Output. In: Elektronik Kompendium
[<a href="https://www.elektronik-kompendium.de/sites/raspberry-pi/2002191.htm" class="bare">https://www.elektronik-kompendium.de/sites/raspberry-pi/2002191.htm</a>; 09.08.2020]</p>
</li>
<li>
<p><a id="GroveSA"></a>[3] Seed Studio. Grove System. In: Seed Studio Wiki [<a href="https://wiki.seeedstudio.com/Grove_System/" class="bare">https://wiki.seeedstudio.com/Grove_System/</a>, 09.08.2020]</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-08-10 11:07:06 +0200
</div>
</div>
</body>
</html>